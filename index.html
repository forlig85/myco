<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BOKLUCK COMMUNITY</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Pretendard:wght@400;600;800&display=swap');
        
        /* ê³ ëŒ€ë¹„ ê°€ë…ì„± ë””ìì¸ */
        body { background-color: #0f172a; color: #f8fafc; font-family: 'Pretendard', sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        
        /* ë°•ìŠ¤ ìŠ¤íƒ€ì¼ */
        .card { background: #1e293b; border: 1px solid #334155; border-radius: 12px; padding: 20px; margin-bottom: 20px; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }
        
        /* ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        button { cursor: pointer; border: none; border-radius: 8px; font-weight: 600; padding: 12px 20px; transition: 0.2s; font-family: 'Pretendard'; }
        .btn-primary { background: #3b82f6; color: white; width: 100%; font-size: 16px; }
        .btn-primary:hover { background: #2563eb; }
        .btn-market { background: linear-gradient(135deg, #8b5cf6, #d946ef); color: white; width: 100%; font-size: 18px; margin-bottom: 20px; box-shadow: 0 4px 15px rgba(139, 92, 246, 0.4); }
        .btn-small { padding: 6px 12px; font-size: 13px; margin-left: 5px; }
        .btn-edit { background: #64748b; color: white; }
        
        /* í—¤ë” & ì§€ê°‘ */
        header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; border-bottom: 2px solid #3b82f6; padding-bottom: 15px; }
        .logo { font-size: 24px; font-weight: 800; color: #38bdf8; }
        .wallet { background: #0f172a; padding: 8px 16px; border-radius: 20px; border: 1px solid #38bdf8; color: #38bdf8; font-weight: bold; }

        /* ê²Œì‹œíŒ ë¦¬ìŠ¤íŠ¸ */
        .board-item { display: flex; justify-content: space-between; align-items: center; padding: 15px; border-bottom: 1px solid #334155; cursor: pointer; transition: 0.2s; }
        .board-item:hover { background: #334155; }
        .board-name { font-size: 18px; font-weight: bold; }
        .board-creator { font-size: 12px; color: #94a3b8; }

        /* ê¸€ ë¦¬ìŠ¤íŠ¸ */
        .post-item { padding: 15px; border-bottom: 1px solid #334155; cursor: pointer; }
        .post-item:hover { background: #2d384d; }
        .post-title { font-size: 16px; font-weight: bold; margin-bottom: 5px; color: #e2e8f0; }
        .post-meta { font-size: 13px; color: #94a3b8; display: flex; justify-content: space-between; }

        /* ê¸€ ìƒì„¸ & ì“°ê¸° */
        input, textarea { width: 100%; background: #0f172a; border: 1px solid #475569; color: white; padding: 15px; border-radius: 8px; box-sizing: border-box; font-size: 16px; margin-bottom: 10px; font-family: 'Pretendard'; }
        input:focus, textarea:focus { outline: none; border-color: #38bdf8; }
        
        .view-content { white-space: pre-wrap; line-height: 1.6; font-size: 16px; color: #e2e8f0; min-height: 100px; }
        .hidden { display: none; }
        .back-link { color: #94a3b8; cursor: pointer; font-size: 14px; margin-bottom: 10px; display: inline-block; }
        .back-link:hover { color: white; text-decoration: underline; }
    </style>
</head>
<body>
    <header>
        <div class="logo">BOKLUCK</div>
        <div id="walletBadge" class="wallet">Loading...</div>
    </header>

    <div id="authSection" class="card" style="text-align: center;">
        <h2>í™˜ì˜í•©ë‹ˆë‹¤!</h2>
        <p style="color:#94a3b8; margin-bottom:20px;">ì»¤ë®¤ë‹ˆí‹°ì— ì°¸ì—¬í•˜ê³  ì½”ì¸ì„ ì±„êµ´í•˜ì„¸ìš”.</p>
        <button id="loginBtn" class="btn-primary">êµ¬ê¸€ ë¡œê·¸ì¸</button>
    </div>

    <div id="mainDashboard" class="hidden">
        <button class="btn-market" onclick="location.href='market.html'">ğŸ›ï¸ êµ­ê°€/ë„ì‹œ ì ë ¹ì „ í•˜ëŸ¬ê°€ê¸° (ë¶€ë™ì‚°)</button>

        <div id="boardListSection">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
                <h3>ğŸ“‚ ê²Œì‹œíŒ ëª©ë¡</h3>
                <button class="btn-small" style="background:#22c55e; color:white;" onclick="createBoard()">+ ê²Œì‹œíŒ êµ¬ë§¤ (1,000 BOK)</button>
            </div>
            <div class="card" id="boardList">
                <div style="padding:20px; text-align:center; color:#94a3b8;">ë¡œë”© ì¤‘...</div>
            </div>
        </div>

        <div id="postListSection" class="hidden">
            <span class="back-link" onclick="showBoardList()">â† ê²Œì‹œíŒ ëª©ë¡ìœ¼ë¡œ</span>
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
                <h3 id="currentBoardName">ììœ ê²Œì‹œíŒ</h3>
                <button class="btn-small btn-primary" onclick="showWriteForm()">ğŸ–Šï¸ ê¸€ì“°ê¸° (ì±„êµ´)</button>
            </div>
            <div class="card" id="postList">
                </div>
        </div>

        <div id="writeSection" class="hidden">
            <span class="back-link" onclick="backToPostList()">â† ì·¨ì†Œ</span>
            <div class="card">
                <h3>âš¡ ì±„êµ´í•˜ê¸° (ê¸€ì“°ê¸°)</h3>
                <input type="text" id="title" placeholder="ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”">
                <textarea id="content" rows="8" placeholder="ë‚´ìš©ì„ 10ì ì´ìƒ ì…ë ¥í•˜ì„¸ìš”."></textarea>
                <button id="saveBtn" class="btn-primary">ë“±ë¡í•˜ê³  ì½”ì¸ ë°›ê¸°</button>
            </div>
        </div>

        <div id="viewSection" class="hidden">
            <span class="back-link" onclick="backToPostList()">â† ëª©ë¡ìœ¼ë¡œ</span>
            <div class="card">
                <h2 id="viewTitle" style="margin-top:0;">ì œëª©</h2>
                <div style="border-bottom:1px solid #334155; padding-bottom:10px; margin-bottom:20px; color:#94a3b8; font-size:14px; display:flex; justify-content:space-between;">
                    <span id="viewAuthor">ì‘ì„±ì</span>
                    <div id="viewControls">
                        </div>
                </div>
                <div id="viewContent" class="view-content">ë‚´ìš©</div>
            </div>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
        import { getFirestore, collection, addDoc, query, orderBy, onSnapshot, doc, setDoc, getDoc, updateDoc, runTransaction, increment, where } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";
        import { getAuth, signInWithPopup, GoogleAuthProvider, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";

        // í‚¤ ì ìš© ì™„ë£Œ
        const firebaseConfig = { apiKey: "AIzaSyBwQjuqgWM4YKnqu_gzNbeCg5alrC-jVcQ", authDomain: "myco-737a0.firebaseapp.com", projectId: "myco-737a0", storageBucket: "myco-737a0.firebasestorage.app", messagingSenderId: "942571332540", appId: "1:942571332540:web:be0bb6fbdd326
