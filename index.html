<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BOKLUCK - ê¸€ ì“°ê³  ë•… ì‚¬ëŠ” Web3 ì»¤ë®¤ë‹ˆí‹°</title>
    
    <!-- SEO ë©”íƒ€íƒœê·¸ -->
    <meta name="description" content="BOKLUCKì—ì„œ ì½˜í…ì¸ ë¥¼ ì‘ì„±í•˜ê³  BOK í† í°ì„ ë°›ìœ¼ì„¸ìš”. ê°€ìƒ ë¶€ë™ì‚°ì— íˆ¬ìí•˜ê³  ì»¤ë®¤ë‹ˆí‹°ë¥¼ ìš´ì˜í•´ë³´ì„¸ìš”!">
    <meta name="keywords" content="Web3, ì»¤ë®¤ë‹ˆí‹°, í† í°, ë¶€ë™ì‚°, BOK, ë³´ìƒ, ê²Œì‹œíŒ">
    <meta name="author" content="BOKLUCK">
    
    <!-- Open Graph / ì†Œì…œ ê³µìœ  -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://bokluck.com/">
    <meta property="og:title" content="BOKLUCK - ê¸€ ì“°ê³  ë•… ì‚¬ëŠ” Web3 ì»¤ë®¤ë‹ˆí‹°">
    <meta property="og:description" content="ì½˜í…ì¸ ë¥¼ ì‘ì„±í•˜ë©´ BOK í† í°ì„ ë°›ê³ , ê°€ìƒ ë¶€ë™ì‚°ì— íˆ¬ìí•´ì„œ ì˜í† ë¥¼ í™•ì¥í•˜ì„¸ìš”!">
    <meta property="og:image" content="https://bokluck.com/og-image.png">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="BOKLUCK - ê¸€ ì“°ê³  ë•… ì‚¬ëŠ” Web3 ì»¤ë®¤ë‹ˆí‹°">
    <meta name="twitter:description" content="ì½˜í…ì¸ ë¥¼ ì‘ì„±í•˜ë©´ BOK í† í°ì„ ë°›ê³ , ê°€ìƒ ë¶€ë™ì‚°ì— íˆ¬ìí•˜ì„¸ìš”!">
    <meta name="twitter:image" content="https://bokluck.com/og-image.png">
    
    <!-- íŒŒë¹„ì½˜ -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ°</text></svg>">
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ°</text></svg>">
    
    <!-- PWA ë§¤ë‹ˆí˜ìŠ¤íŠ¸ -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#6366f1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700;900&display=swap" rel="stylesheet">
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        :root {
            --primary: #6366f1; --primary-light: #818cf8; --secondary: #06b6d4;
            --accent: #f59e0b; --success: #10b981; --danger: #ef4444; --pink: #ec4899;
            --bg-dark: #0a0a0f; --bg-card: #12121a; --bg-card-hover: #1a1a25;
            --border: #2a2a3a; --text: #f0f0f5; --text-muted: #8888a0;
            --gradient-primary: linear-gradient(135deg, #6366f1 0%, #06b6d4 100%);
            --gradient-gold: linear-gradient(135deg, #f59e0b 0%, #fbbf24 100%);
            --gradient-pink: linear-gradient(135deg, #ec4899 0%, #8b5cf6 100%);
        }
        
        /* ë¼ì´íŠ¸ ëª¨ë“œ */
        [data-theme="light"] {
            --bg-dark: #f5f5f7; --bg-card: #ffffff; --bg-card-hover: #f0f0f2;
            --border: #e0e0e5; --text: #1a1a2e; --text-muted: #6b7280;
        }
        
        body { background-color: var(--bg-dark); background-image: radial-gradient(ellipse at top, rgba(99,102,241,0.1) 0%, transparent 50%); color: var(--text); font-family: 'Noto Sans KR', sans-serif; min-height: 100vh; transition: background-color 0.3s, color 0.3s; }
        
        /* ë¡œë”© ìŠ¤í”¼ë„ˆ */
        .loading-overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: var(--bg-dark); display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 9999; transition: opacity 0.5s; }
        .loading-overlay.fade-out { opacity: 0; pointer-events: none; }
        .spinner { width: 50px; height: 50px; border: 4px solid var(--border); border-top-color: var(--primary); border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
        .loading-text { margin-top: 16px; color: var(--text-muted); font-size: 14px; }
        
        /* ìŠ¤ì¼ˆë ˆí†¤ ë¡œë”© */
        .skeleton { background: linear-gradient(90deg, var(--bg-card-hover) 25%, var(--border) 50%, var(--bg-card-hover) 75%); background-size: 200% 100%; animation: shimmer 1.5s infinite; border-radius: 8px; }
        @keyframes shimmer { 0% { background-position: 200% 0; } 100% { background-position: -200% 0; } }
        .skeleton-text { height: 16px; margin-bottom: 8px; }
        .skeleton-title { height: 24px; width: 60%; margin-bottom: 12px; }
        .skeleton-circle { width: 40px; height: 40px; border-radius: 50%; }
        
        /* ì—ëŸ¬ ë°”ìš´ë”ë¦¬ */
        .error-container { text-align: center; padding: 60px 20px; }
        .error-icon { font-size: 64px; margin-bottom: 16px; }
        .error-title { font-size: 20px; font-weight: 700; margin-bottom: 8px; }
        .error-message { color: var(--text-muted); margin-bottom: 20px; }
        
        /* ë„¤ë¹„ê²Œì´ì…˜ */
        .navbar { background: var(--bg-card); border-bottom: 1px solid var(--border); padding: 12px 20px; position: sticky; top: 0; z-index: 100; }
        .nav-container { max-width: 1200px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center; }
        .logo { font-size: 24px; font-weight: 900; background: var(--gradient-primary); -webkit-background-clip: text; -webkit-text-fill-color: transparent; cursor: pointer; }
        .nav-links { display: flex; gap: 8px; }
        .nav-link { padding: 8px 16px; border-radius: 8px; color: var(--text-muted); text-decoration: none; font-size: 14px; font-weight: 500; transition: all 0.2s; }
        .nav-link:hover, .nav-link.active { background: var(--bg-card-hover); color: var(--text); }
        
        /* ë‹¤í¬/ë¼ì´íŠ¸ í† ê¸€ */
        .theme-toggle { width: 40px; height: 40px; border-radius: 50%; background: var(--bg-dark); border: 1px solid var(--border); cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 18px; transition: all 0.3s; }
        .theme-toggle:hover { border-color: var(--primary); }
        
        /* í–„ë²„ê±° ë©”ë‰´ */
        .hamburger { display: none; flex-direction: column; gap: 5px; cursor: pointer; padding: 8px; }
        .hamburger span { width: 24px; height: 2px; background: var(--text); transition: all 0.3s; }
        .hamburger.active span:nth-child(1) { transform: rotate(45deg) translate(5px, 5px); }
        .hamburger.active span:nth-child(2) { opacity: 0; }
        .hamburger.active span:nth-child(3) { transform: rotate(-45deg) translate(5px, -5px); }
        
        .mobile-menu { display: none; position: fixed; top: 60px; left: 0; right: 0; bottom: 0; background: var(--bg-dark); z-index: 99; padding: 20px; flex-direction: column; gap: 8px; }
        .mobile-menu.active { display: flex; }
        .mobile-menu .nav-link { padding: 16px; font-size: 16px; border-radius: 12px; background: var(--bg-card); }
        
        /* ì•Œë¦¼ ë²¨ */
        .notification-bell { position: relative; cursor: pointer; padding: 8px; }
        .notification-bell .badge { position: absolute; top: 2px; right: 2px; background: var(--danger); color: white; font-size: 10px; font-weight: 700; min-width: 18px; height: 18px; border-radius: 50%; display: flex; align-items: center; justify-content: center; animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.1); } }
        .notification-dropdown { position: absolute; top: 100%; right: 0; width: 320px; max-height: 400px; overflow-y: auto; background: var(--bg-card); border: 1px solid var(--border); border-radius: 12px; display: none; z-index: 200; box-shadow: 0 10px 40px rgba(0,0,0,0.5); }
        .notification-dropdown.active { display: block; }
        .notification-header { padding: 16px; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; }
        .notification-item { padding: 12px 16px; border-bottom: 1px solid var(--border); cursor: pointer; transition: background 0.2s; }
        .notification-item:hover { background: var(--bg-card-hover); }
        .notification-item.unread { background: rgba(99,102,241,0.1); }
        .notification-icon { font-size: 20px; margin-right: 12px; }
        .notification-text { font-size: 13px; line-height: 1.4; }
        .notification-time { font-size: 11px; color: var(--text-muted); margin-top: 4px; }
        
        /* ê²€ìƒ‰ë°” */
        .search-container { position: relative; }
        .search-input { background: var(--bg-dark); border: 1px solid var(--border); border-radius: 50px; padding: 8px 16px 8px 36px; color: var(--text); font-size: 14px; width: 200px; transition: all 0.3s; }
        .search-input:focus { outline: none; border-color: var(--primary); width: 280px; }
        .search-icon { position: absolute; left: 12px; top: 50%; transform: translateY(-50%); color: var(--text-muted); }
        .search-results { position: absolute; top: 100%; left: 0; right: 0; background: var(--bg-card); border: 1px solid var(--border); border-radius: 12px; margin-top: 8px; display: none; z-index: 200; max-height: 400px; overflow-y: auto; }
        .search-results.active { display: block; }
        .search-result-item { padding: 12px 16px; cursor: pointer; border-bottom: 1px solid var(--border); }
        .search-result-item:hover { background: var(--bg-card-hover); }
        
        .nav-right { display: flex; align-items: center; gap: 12px; }
        .wallet-badge { background: var(--bg-dark); padding: 8px 16px; border-radius: 50px; border: 1px solid var(--border); color: var(--secondary); font-weight: 700; font-size: 14px; }
        .level-badge { background: var(--gradient-gold); color: #1a1a2e; padding: 4px 10px; border-radius: 20px; font-size: 12px; font-weight: 700; }
        
        .container { max-width: 1200px; margin: 0 auto; padding: 24px 20px; }
        .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .grid-3 { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; }
        .card { background: var(--bg-card); border: 1px solid var(--border); border-radius: 16px; padding: 24px; transition: all 0.3s; }
        .card:hover { border-color: rgba(99,102,241,0.3); }
        .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; }
        .card-title { font-size: 18px; font-weight: 700; display: flex; align-items: center; gap: 8px; }
        
        button { cursor: pointer; border: none; border-radius: 10px; font-weight: 600; padding: 12px 20px; transition: all 0.3s; font-family: 'Noto Sans KR', sans-serif; font-size: 14px; }
        button:hover { transform: translateY(-2px); }
        button:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }
        .btn-primary { background: var(--gradient-primary); color: white; box-shadow: 0 4px 15px rgba(99,102,241,0.3); }
        .btn-gold { background: var(--gradient-gold); color: #1a1a2e; }
        .btn-pink { background: var(--gradient-pink); color: white; }
        .btn-outline { background: transparent; border: 1px solid var(--border); color: var(--text); }
        .btn-sm { padding: 8px 14px; font-size: 13px; }
        .btn-block { width: 100%; }
        
        /* ë¡œê·¸ì¸ í•„ìš” ì˜¤ë²„ë ˆì´ */
        .login-required-overlay { position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(10,10,15,0.85); backdrop-filter: blur(8px); display: flex; flex-direction: column; align-items: center; justify-content: center; border-radius: 16px; z-index: 10; }
        .login-required-overlay .lock-icon { font-size: 48px; margin-bottom: 16px; }
        .login-required-overlay p { color: var(--text-muted); margin-bottom: 16px; text-align: center; }
        
        /* íˆì–´ë¡œ ì„¹ì…˜ */
        .hero { text-align: center; padding: 60px 20px; background: var(--bg-card); border-radius: 24px; margin-bottom: 24px; border: 1px solid var(--border); position: relative; overflow: hidden; }
        .hero::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 3px; background: var(--gradient-primary); }
        .hero-badge { display: inline-block; background: rgba(99,102,241,0.1); border: 1px solid rgba(99,102,241,0.3); color: var(--primary-light); padding: 6px 16px; border-radius: 50px; font-size: 13px; font-weight: 600; margin-bottom: 20px; }
        .hero-title { font-size: 36px; font-weight: 900; margin-bottom: 16px; line-height: 1.3; }
        .hero-title .highlight { background: var(--gradient-primary); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .hero-subtitle { font-size: 16px; color: var(--text-muted); margin-bottom: 32px; }
        .stats-bar { display: flex; justify-content: center; gap: 40px; margin-bottom: 32px; }
        .stat-item { text-align: center; }
        .stat-number { font-size: 28px; font-weight: 900; background: var(--gradient-primary); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .stat-label { font-size: 13px; color: var(--text-muted); }
        
        .feature-card { background: var(--bg-card); border: 1px solid var(--border); border-radius: 16px; padding: 24px; text-align: center; transition: all 0.3s; cursor: pointer; }
        .feature-card:hover { transform: translateY(-4px); border-color: var(--primary); box-shadow: 0 10px 30px rgba(99,102,241,0.15); }
        .feature-icon { font-size: 40px; margin-bottom: 16px; }
        .feature-title { font-weight: 700; margin-bottom: 8px; }
        .feature-desc { font-size: 13px; color: var(--text-muted); }
        
        /* ë¯¸ì…˜ */
        .mission-item { display: flex; align-items: center; justify-content: space-between; padding: 16px; background: var(--bg-dark); border-radius: 12px; margin-bottom: 10px; border: 1px solid var(--border); }
        .mission-item.completed { opacity: 0.6; }
        .mission-info { display: flex; align-items: center; gap: 12px; }
        .mission-icon { width: 40px; height: 40px; background: var(--bg-card-hover); border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 20px; }
        .mission-title { font-weight: 600; font-size: 14px; }
        .mission-progress { font-size: 12px; color: var(--text-muted); }
        .mission-reward { background: rgba(16,185,129,0.1); color: var(--success); padding: 6px 12px; border-radius: 20px; font-size: 13px; font-weight: 600; }
        .mission-complete-badge { background: var(--success); color: white; padding: 6px 12px; border-radius: 20px; font-size: 12px; font-weight: 600; }
        
        .progress-bar { height: 8px; background: var(--bg-dark); border-radius: 4px; overflow: hidden; margin-top: 8px; }
        .progress-fill { height: 100%; background: var(--gradient-primary); border-radius: 4px; transition: width 0.5s ease; }
        
        /* ì¸ê¸°ê¸€ */
        .hot-post-item { display: flex; align-items: center; gap: 12px; padding: 12px; background: var(--bg-dark); border-radius: 10px; margin-bottom: 8px; cursor: pointer; transition: all 0.2s; border: 1px solid var(--border); }
        .hot-post-item:hover { background: var(--bg-card-hover); border-color: var(--primary); }
        .hot-rank { width: 28px; height: 28px; background: var(--gradient-gold); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 12px; color: #1a1a2e; flex-shrink: 0; }
        .hot-post-info { flex: 1; min-width: 0; }
        .hot-post-title { font-weight: 600; font-size: 14px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .hot-post-meta { font-size: 12px; color: var(--text-muted); }
        .hot-post-stats { font-size: 12px; color: var(--danger); font-weight: 600; }
        
        /* ë¹ˆ ìƒíƒœ */
        .empty-state { text-align: center; padding: 40px 20px; }
        .empty-state .empty-icon { font-size: 48px; margin-bottom: 12px; opacity: 0.5; }
        .empty-state .empty-title { font-weight: 600; margin-bottom: 8px; }
        .empty-state .empty-desc { font-size: 13px; color: var(--text-muted); }
        .empty-state .cta-text { color: var(--primary-light); font-weight: 600; margin-top: 12px; cursor: pointer; }
        
        /* ë­í‚¹ */
        .ranking-item { display: flex; align-items: center; gap: 12px; padding: 12px; background: var(--bg-dark); border-radius: 10px; margin-bottom: 8px; }
        .ranking-position { width: 28px; height: 28px; background: var(--bg-card-hover); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 13px; }
        .ranking-position.gold { background: var(--gradient-gold); color: #1a1a2e; }
        .ranking-position.silver { background: linear-gradient(135deg, #94a3b8, #cbd5e1); color: #1a1a2e; }
        .ranking-position.bronze { background: linear-gradient(135deg, #b45309, #d97706); color: white; }
        .ranking-name { flex: 1; font-weight: 500; }
        .ranking-score { color: var(--secondary); font-weight: 700; }
        
        /* ì¶œì„ ë‹¬ë ¥ */
        .calendar-container { margin-top: 16px; }
        .calendar-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
        .calendar-month { font-weight: 700; font-size: 16px; }
        .calendar-nav { display: flex; gap: 8px; }
        .calendar-nav button { padding: 6px 10px; background: var(--bg-dark); border: 1px solid var(--border); border-radius: 6px; color: var(--text); cursor: pointer; }
        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 4px; }
        .calendar-day-header { text-align: center; font-size: 11px; color: var(--text-muted); padding: 8px 0; }
        .calendar-day { aspect-ratio: 1; display: flex; align-items: center; justify-content: center; border-radius: 8px; font-size: 12px; font-weight: 500; background: var(--bg-dark); position: relative; }
        .calendar-day.today { border: 2px solid var(--primary); }
        .calendar-day.attended { background: var(--gradient-primary); color: white; }
        .calendar-day.attended::after { content: 'âœ“'; position: absolute; font-size: 10px; }
        .calendar-day.future { opacity: 0.3; }
        .streak-info { display: flex; justify-content: center; gap: 24px; margin-top: 16px; padding: 16px; background: var(--bg-dark); border-radius: 12px; }
        .streak-item { text-align: center; }
        .streak-value { font-size: 24px; font-weight: 900; color: var(--accent); }
        .streak-label { font-size: 12px; color: var(--text-muted); }
        
        /* ì¶œì„ í˜œíƒ ì¹´ë“œ (ë¡œê·¸ì¸ ì „) */
        .attendance-benefits { background: linear-gradient(135deg, rgba(99,102,241,0.1), rgba(236,72,153,0.1)); border: 1px solid rgba(99,102,241,0.3); border-radius: 16px; padding: 24px; text-align: center; }
        .attendance-benefits h4 { margin-bottom: 16px; }
        .benefit-item { display: flex; align-items: center; gap: 12px; padding: 12px; background: var(--bg-dark); border-radius: 10px; margin-bottom: 8px; text-align: left; }
        .benefit-icon { font-size: 24px; }
        .benefit-text { font-size: 13px; }
        .benefit-text strong { color: var(--accent); }
        
        /* ë£°ë › */
        .roulette-container { text-align: center; padding: 20px; }
        .roulette-wheel { width: 200px; height: 200px; border-radius: 50%; background: conic-gradient(var(--primary) 0deg 45deg, var(--secondary) 45deg 90deg, var(--accent) 90deg 135deg, var(--success) 135deg 180deg, var(--pink) 180deg 225deg, var(--danger) 225deg 270deg, var(--primary-light) 270deg 315deg, #fbbf24 315deg 360deg); margin: 0 auto 20px; position: relative; transition: transform 3s cubic-bezier(0.17,0.67,0.12,0.99); box-shadow: 0 0 30px rgba(99,102,241,0.3); }
        .roulette-wheel::before { content: 'ğŸ¯'; position: absolute; top: 50%; left: 50%; transform: translate(-50%,-50%); font-size: 40px; background: var(--bg-dark); width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; }
        .roulette-pointer { position: absolute; top: -10px; left: 50%; transform: translateX(-50%); font-size: 24px; }
        .streak-bonus { display: inline-block; background: var(--gradient-gold); color: #1a1a2e; padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: 700; margin-top: 8px; }
        
        /* ë™ê¸°ë¶€ì—¬ ë¬¸êµ¬ */
        .motivational-text { background: linear-gradient(135deg, rgba(245,158,11,0.1), rgba(16,185,129,0.1)); border: 1px solid rgba(245,158,11,0.3); color: var(--accent); padding: 12px 16px; border-radius: 10px; font-size: 14px; text-align: center; margin-bottom: 16px; }
        
        /* í”„ë¡œí•„ */
        .profile-header { display: flex; align-items: center; gap: 20px; margin-bottom: 24px; }
        .profile-avatar { width: 80px; height: 80px; border-radius: 50%; background: var(--gradient-primary); display: flex; align-items: center; justify-content: center; font-size: 36px; }
        .profile-info h2 { font-size: 24px; margin-bottom: 4px; }
        .profile-stats { display: flex; gap: 20px; color: var(--text-muted); font-size: 14px; }
        
        /* ì—…ì  */
        .achievement-item { display: flex; align-items: center; gap: 12px; padding: 14px; background: var(--bg-dark); border-radius: 12px; margin-bottom: 10px; border: 1px solid var(--border); }
        .achievement-icon { width: 44px; height: 44px; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 22px; }
        .achievement-locked { background: var(--bg-card-hover); opacity: 0.5; }
        .achievement-unlocked { background: var(--gradient-gold); }
        .achievement-info { flex: 1; }
        .achievement-title { font-weight: 600; font-size: 14px; }
        .achievement-desc { font-size: 12px; color: var(--text-muted); }
        
        /* ê²Œì‹œíŒ */
        .board-item { display: flex; align-items: center; gap: 16px; padding: 16px; background: var(--bg-dark); border-radius: 12px; margin-bottom: 10px; cursor: pointer; transition: all 0.2s; border: 1px solid var(--border); }
        .board-item:hover { background: var(--bg-card-hover); border-color: var(--primary); }
        .board-icon { width: 48px; height: 48px; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 24px; }
        .board-info { flex: 1; }
        .board-name { font-weight: 700; margin-bottom: 4px; }
        .board-meta { font-size: 12px; color: var(--text-muted); }
        .board-stats { display: flex; gap: 16px; font-size: 12px; color: var(--text-muted); }
        .board-fee { background: rgba(245,158,11,0.1); color: var(--accent); padding: 4px 10px; border-radius: 20px; font-size: 12px; font-weight: 600; }
        
        .tabs { display: flex; gap: 4px; background: var(--bg-dark); padding: 4px; border-radius: 12px; margin-bottom: 20px; }
        .tab { flex: 1; padding: 10px; text-align: center; border-radius: 8px; font-weight: 600; font-size: 14px; cursor: pointer; transition: all 0.2s; color: var(--text-muted); }
        .tab.active { background: var(--bg-card); color: var(--text); }
        
        /* ì˜¨ë³´ë”© ëª¨ë‹¬ */
        .onboarding-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); display: none; justify-content: center; align-items: center; z-index: 2000; backdrop-filter: blur(10px); }
        .onboarding-content { background: var(--bg-card); border-radius: 24px; width: 90%; max-width: 500px; padding: 40px; text-align: center; border: 1px solid var(--border); position: relative; }
        .onboarding-step { display: none; }
        .onboarding-step.active { display: block; }
        .onboarding-icon { font-size: 72px; margin-bottom: 24px; }
        .onboarding-title { font-size: 24px; font-weight: 900; margin-bottom: 12px; }
        .onboarding-desc { color: var(--text-muted); margin-bottom: 32px; line-height: 1.6; }
        .onboarding-dots { display: flex; justify-content: center; gap: 8px; margin-bottom: 24px; }
        .onboarding-dot { width: 10px; height: 10px; border-radius: 50%; background: var(--border); transition: all 0.3s; }
        .onboarding-dot.active { background: var(--primary); width: 24px; border-radius: 5px; }
        .onboarding-skip { position: absolute; top: 16px; right: 16px; color: var(--text-muted); cursor: pointer; font-size: 14px; }
        
        /* ëª¨ë‹¬ */
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); display: none; justify-content: center; align-items: center; z-index: 1000; backdrop-filter: blur(8px); }
        .modal-content { background: var(--bg-card); padding: 32px; border-radius: 20px; width: 90%; max-width: 500px; max-height: 80vh; overflow-y: auto; border: 1px solid var(--border); position: relative; }
        .modal-close { position: absolute; top: 16px; right: 16px; background: var(--bg-dark); border: none; width: 32px; height: 32px; border-radius: 50%; cursor: pointer; font-size: 18px; color: var(--text-muted); }
        .modal-title { font-size: 22px; font-weight: 900; margin-bottom: 20px; text-align: center; }
        
        input, textarea, select { width: 100%; background: var(--bg-dark); border: 1px solid var(--border); color: var(--text); padding: 14px 16px; border-radius: 10px; font-size: 15px; font-family: 'Noto Sans KR', sans-serif; margin-bottom: 12px; transition: all 0.2s; }
        input:focus, textarea:focus, select:focus { outline: none; border-color: var(--primary); }
        label { display: block; font-size: 13px; color: var(--text-muted); margin-bottom: 6px; font-weight: 500; }
        
        .toggle-row { display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid var(--border); }
        .toggle-switch { width: 48px; height: 26px; background: var(--bg-dark); border-radius: 13px; position: relative; cursor: pointer; transition: all 0.3s; }
        .toggle-switch.active { background: var(--success); }
        .toggle-switch::before { content: ''; position: absolute; top: 3px; left: 3px; width: 20px; height: 20px; background: white; border-radius: 50%; transition: all 0.3s; }
        .toggle-switch.active::before { left: 25px; }
        
        .invite-box { background: var(--bg-dark); border: 2px dashed var(--border); border-radius: 12px; padding: 20px; text-align: center; }
        .invite-code { font-size: 28px; font-weight: 900; letter-spacing: 4px; color: var(--primary-light); background: var(--bg-dark); padding: 12px 24px; border-radius: 12px; font-family: monospace; }
        
        .hidden { display: none !important; }
        .title-badge { background: var(--gradient-gold); color: #1a1a2e; padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: 700; white-space: nowrap; }
        .country-flag { font-size: 18px; }
        .title-option { background: var(--bg-dark); border: 1px solid var(--border); padding: 8px 14px; border-radius: 20px; font-size: 13px; cursor: pointer; transition: all 0.2s; }
        .title-option:hover { border-color: var(--primary); }
        .title-option.active { background: var(--gradient-gold); color: #1a1a2e; border-color: transparent; }
        .title-option.locked { opacity: 0.4; cursor: not-allowed; }
        
        /* ì´ˆëŒ€ ì‹œìŠ¤í…œ */
        .reward-steps { display: flex; flex-direction: column; gap: 12px; }
        .reward-step { display: flex; align-items: center; gap: 12px; padding: 12px; background: var(--bg-card); border-radius: 10px; }
        .step-icon { font-size: 20px; }
        .step-info { flex: 1; }
        .step-title { font-weight: 600; font-size: 14px; margin-bottom: 4px; }
        .step-rewards { display: flex; gap: 8px; }
        .reward-tag { font-size: 11px; padding: 3px 8px; border-radius: 10px; font-weight: 600; }
        .reward-tag.inviter { background: rgba(16,185,129,0.15); color: var(--success); }
        .reward-tag.invitee { background: rgba(99,102,241,0.15); color: var(--primary-light); }
        .milestone-list { display: flex; flex-wrap: wrap; gap: 8px; }
        .milestone-item { display: flex; align-items: center; justify-content: space-between; background: var(--bg-card); padding: 8px 12px; border-radius: 8px; flex: 1; min-width: 120px; font-size: 13px; }
        .milestone-item.achieved { background: var(--gradient-gold); color: #1a1a2e; }
        .milestone-reward { font-weight: 700; color: var(--accent); }
        .milestone-item.achieved .milestone-reward { color: #1a1a2e; }
        .invited-friend { display: flex; align-items: center; justify-content: space-between; padding: 10px; background: var(--bg-dark); border-radius: 8px; margin-bottom: 6px; font-size: 13px; }
        .friend-status { display: flex; gap: 4px; }
        .status-badge { width: 8px; height: 8px; border-radius: 50%; }
        .status-badge.done { background: var(--success); }
        .status-badge.pending { background: var(--border); }
        
        .invite-banner { background: linear-gradient(135deg, rgba(99,102,241,0.1), rgba(236,72,153,0.1)); border: 1px solid rgba(99,102,241,0.3); border-radius: 12px; padding: 16px; margin-bottom: 20px; display: flex; align-items: center; justify-content: space-between; gap: 12px; }
        .invite-banner-text { font-size: 14px; }
        .invite-banner-text strong { color: var(--primary-light); }
        
        /* BOK ì†¡ê¸ˆ */
        .send-bok-section { background: var(--bg-dark); border-radius: 12px; padding: 20px; margin-top: 20px; }
        .user-search-result { display: flex; align-items: center; gap: 12px; padding: 12px; background: var(--bg-card); border-radius: 10px; margin-top: 12px; cursor: pointer; }
        .user-search-result:hover { background: var(--bg-card-hover); }
        
        /* ë¯¸ì…˜ ì™„ë£Œ ë³´ë„ˆìŠ¤ */
        .all-missions-bonus { background: linear-gradient(135deg, rgba(245,158,11,0.2), rgba(236,72,153,0.2)); border: 2px solid var(--accent); border-radius: 12px; padding: 16px; text-align: center; margin-top: 16px; }
        .all-missions-bonus.claimable { animation: glow 2s infinite; }
        @keyframes glow { 0%, 100% { box-shadow: 0 0 10px rgba(245,158,11,0.3); } 50% { box-shadow: 0 0 20px rgba(245,158,11,0.6); } }
        
        /* ìƒëŒ€ì  ìœ„ì¹˜ ì»¨í…Œì´ë„ˆ */
        .relative { position: relative; }
        
        /* PWA ì„¤ì¹˜ ë°°ë„ˆ */
        .pwa-install-banner { position: fixed; bottom: 20px; left: 20px; right: 20px; background: var(--gradient-primary); padding: 16px 20px; border-radius: 16px; display: none; align-items: center; justify-content: space-between; gap: 12px; z-index: 1000; box-shadow: 0 10px 40px rgba(99,102,241,0.4); }
        .pwa-install-banner.show { display: flex; }
        .pwa-install-text { color: white; font-size: 14px; }
        .pwa-install-text strong { display: block; font-size: 16px; margin-bottom: 4px; }
        .pwa-install-actions { display: flex; gap: 8px; }
        .pwa-install-actions button { padding: 10px 16px; }
        
        @media (max-width: 768px) { 
            .grid-2, .grid-3 { grid-template-columns: 1fr; } 
            .nav-links { display: none; } 
            .hamburger { display: flex; }
            .hero-title { font-size: 26px; } 
            .stats-bar { gap: 20px; } 
            .stat-number { font-size: 22px; } 
            .milestone-item { min-width: 100%; }
            .search-input { width: 150px; }
            .search-input:focus { width: 200px; }
            .notification-dropdown { width: 280px; right: -50px; }
            .pwa-install-banner { flex-direction: column; text-align: center; }
        }
    </style>
</head>
<body>
    <!-- ë¡œë”© ì˜¤ë²„ë ˆì´ -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="spinner"></div>
        <div class="loading-text">BOKLUCK ë¡œë”© ì¤‘...</div>
    </div>

    <!-- ì˜¨ë³´ë”© ëª¨ë‹¬ -->
    <div class="onboarding-overlay" id="onboardingOverlay">
        <div class="onboarding-content">
            <span class="onboarding-skip" onclick="skipOnboarding()">ê±´ë„ˆë›°ê¸°</span>
            
            <div class="onboarding-step active" data-step="1">
                <div class="onboarding-icon">âœï¸</div>
                <div class="onboarding-title">ê¸€ì“°ê¸°ë¡œ ëˆ ë²Œê¸°</div>
                <div class="onboarding-desc">ê²Œì‹œê¸€ì„ ì‘ì„±í•˜ë©´ <strong style="color: var(--accent);">100 BOK</strong>ì„ ë°›ì•„ìš”!<br>ëŒ“ê¸€ê³¼ ì¢‹ì•„ìš”ë¡œ ì¶”ê°€ ìˆ˜ìµë„ ì–»ì„ ìˆ˜ ìˆì–´ìš”.</div>
            </div>
            
            <div class="onboarding-step" data-step="2">
                <div class="onboarding-icon">ğŸ—ï¸</div>
                <div class="onboarding-title">ê²Œì‹œíŒ ìš´ì˜í•˜ê¸°</div>
                <div class="onboarding-desc">ë‚˜ë§Œì˜ ê²Œì‹œíŒì„ ë§Œë“¤ê³  ìš´ì˜í•´ë³´ì„¸ìš”!<br>ì…ì¥ë£Œì™€ ìˆ˜ìˆ˜ë£Œë¡œ <strong style="color: var(--accent);">ìˆ˜ìµ</strong>ì„ ì°½ì¶œí•  ìˆ˜ ìˆì–´ìš”.</div>
            </div>
            
            <div class="onboarding-step" data-step="3">
                <div class="onboarding-icon">ğŸ—ºï¸</div>
                <div class="onboarding-title">ë¶€ë™ì‚° íˆ¬ì</div>
                <div class="onboarding-desc">ê°€ìƒ ë•…ì„ êµ¬ë§¤í•˜ë©´ <strong style="color: var(--accent);">1~1,000 BOK</strong>ì˜<br>ëœë¤ ê°€ì¹˜ê°€ ë¶€ì—¬ë¼ìš”. ëŒ€ë°•ì˜ ê¸°íšŒ!</div>
            </div>
            
            <div class="onboarding-dots">
                <div class="onboarding-dot active" data-dot="1"></div>
                <div class="onboarding-dot" data-dot="2"></div>
                <div class="onboarding-dot" data-dot="3"></div>
            </div>
            
            <button class="btn-primary btn-block" onclick="nextOnboardingStep()">
                <span id="onboardingBtnText">ë‹¤ìŒ</span>
            </button>
        </div>
    </div>

    <!-- PWA ì„¤ì¹˜ ë°°ë„ˆ -->
    <div class="pwa-install-banner" id="pwaInstallBanner">
        <div class="pwa-install-text">
            <strong>ğŸ“± ì•±ìœ¼ë¡œ ì„¤ì¹˜í•˜ê¸°</strong>
            í™ˆ í™”ë©´ì— ì¶”ê°€í•˜ê³  ë” ë¹ ë¥´ê²Œ ì´ìš©í•˜ì„¸ìš”!
        </div>
        <div class="pwa-install-actions">
            <button class="btn-outline btn-sm" onclick="dismissPwaBanner()">ë‚˜ì¤‘ì—</button>
            <button class="btn-gold btn-sm" onclick="installPwa()">ì„¤ì¹˜</button>
        </div>
    </div>

    <nav class="navbar">
        <div class="nav-container">
            <div class="logo" onclick="showSection('home')">BOKLUCK</div>
            
            <!-- ê²€ìƒ‰ë°” -->
            <div class="search-container" id="searchContainer">
                <span class="search-icon">ğŸ”</span>
                <input type="text" class="search-input" id="searchInput" placeholder="ê²€ìƒ‰..." oninput="handleSearch(event)" onfocus="document.getElementById('searchResults').classList.add('active')" onblur="setTimeout(()=>document.getElementById('searchResults').classList.remove('active'), 200)">
                <div class="search-results" id="searchResults"></div>
            </div>
            
            <div class="nav-links" id="navLinks">
                <a href="#" class="nav-link active" onclick="showSection('home')">ğŸ  í™ˆ</a>
                <a href="#" class="nav-link" onclick="showSection('boards')">ğŸ“‚ ê²Œì‹œíŒ</a>
                <a href="market.html" class="nav-link">ğŸ—ºï¸ ë¶€ë™ì‚°</a>
                <a href="board-market.html" class="nav-link">ğŸª ë§ˆì¼“</a>
                <a href="#" class="nav-link" onclick="showSection('profile')">ğŸ‘¤ í”„ë¡œí•„</a>
            </div>
            
            <div class="nav-right">
                <!-- ë‹¤í¬/ë¼ì´íŠ¸ í† ê¸€ -->
                <button class="theme-toggle" id="themeToggle" onclick="toggleTheme()">ğŸŒ™</button>
                
                <!-- ì•Œë¦¼ ë²¨ -->
                <div class="notification-bell" id="notificationBell" onclick="toggleNotifications()">
                    ğŸ””
                    <span class="badge hidden" id="notifBadge">0</span>
                    <div class="notification-dropdown" id="notificationDropdown">
                        <div class="notification-header">
                            <strong>ì•Œë¦¼</strong>
                            <button class="btn-sm btn-outline" onclick="markAllRead(event)">ëª¨ë‘ ì½ìŒ</button>
                        </div>
                        <div id="notificationList">
                            <div style="padding: 40px; text-align: center; color: var(--text-muted);">ì•Œë¦¼ì´ ì—†ìŠµë‹ˆë‹¤</div>
                        </div>
                    </div>
                </div>
                
                <span class="level-badge" id="levelBadge">Lv.1</span>
                <div class="wallet-badge" id="walletBadge">ğŸ’° ì—°ê²° í•„ìš”</div>
                
                <!-- í–„ë²„ê±° ë©”ë‰´ -->
                <div class="hamburger" id="hamburger" onclick="toggleMobileMenu()">
                    <span></span><span></span><span></span>
                </div>
                
                <button class="btn-sm btn-outline hidden" id="logoutBtn" onclick="logout()" style="padding: 8px 12px;">ğŸšª</button>
            </div>
        </div>
    </nav>
    
    <!-- ëª¨ë°”ì¼ ë©”ë‰´ -->
    <div class="mobile-menu" id="mobileMenu">
        <a href="#" class="nav-link" onclick="showSection('home'); toggleMobileMenu();">ğŸ  í™ˆ</a>
        <a href="#" class="nav-link" onclick="showSection('boards'); toggleMobileMenu();">ğŸ“‚ ê²Œì‹œíŒ</a>
        <a href="market.html" class="nav-link">ğŸ—ºï¸ ë¶€ë™ì‚°</a>
        <a href="board-market.html" class="nav-link">ğŸª ë§ˆì¼“</a>
        <a href="#" class="nav-link" onclick="showSection('profile'); toggleMobileMenu();">ğŸ‘¤ í”„ë¡œí•„</a>
    </div>

    <div class="container">
        <!-- ì—ëŸ¬ ë°”ìš´ë”ë¦¬ -->
        <div id="errorContainer" class="hidden">
            <div class="error-container">
                <div class="error-icon">ğŸ˜µ</div>
                <div class="error-title">ì—°ê²°ì— ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤</div>
                <div class="error-message">ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.</div>
                <button class="btn-primary" onclick="location.reload()">ìƒˆë¡œê³ ì¹¨</button>
            </div>
        </div>

        <!-- ë¡œê·¸ì¸ ì „ -->
        <div id="authSection">
            <div class="hero">
                <span class="hero-badge">ğŸš€ Web3 ì»¤ë®¤ë‹ˆí‹°</span>
                <h1 class="hero-title">ê¸€ ì“°ê³ , ë•… ì‚¬ê³ ,<br><span class="highlight">ë¶€ì ë˜ì!</span></h1>
                <p class="hero-subtitle">ì½˜í…ì¸ ë¥¼ ì‘ì„±í•˜ë©´ BOK í† í°ì„ ë°›ê³ ,<br>ê°€ìƒ ë¶€ë™ì‚°ì— íˆ¬ìí•´ì„œ ì˜í† ë¥¼ í™•ì¥í•˜ì„¸ìš”!</p>
                <div class="stats-bar">
                    <div class="stat-item">
                        <div class="stat-number" id="statUsers">
                            <span class="skeleton skeleton-text" style="width: 60px; display: inline-block;"></span>
                        </div>
                        <div class="stat-label">í™œì„± ìœ ì €</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number" id="statPosts">
                            <span class="skeleton skeleton-text" style="width: 60px; display: inline-block;"></span>
                        </div>
                        <div class="stat-label">ì‘ì„±ëœ ê¸€</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number" id="statLands">
                            <span class="skeleton skeleton-text" style="width: 60px; display: inline-block;"></span>
                        </div>
                        <div class="stat-label">ê±°ë˜ëœ ë•…</div>
                    </div>
                </div>
                <button class="btn-primary" id="loginBtn" style="max-width: 320px;">Google ê³„ì •ìœ¼ë¡œ ì‹œì‘í•˜ê¸°</button>
                <div style="margin-top: 20px;"><input type="text" id="inviteCodeInput" placeholder="ì´ˆëŒ€ ì½”ë“œ ì…ë ¥ (ì„ íƒ)" style="max-width: 200px; text-align: center;"></div>
            </div>
            <div class="grid-3">
                <div class="feature-card"><div class="feature-icon">âœï¸</div><div class="feature-title">ê¸€ì“°ê¸° ë³´ìƒ</div><div class="feature-desc">ê¸€ í•˜ë‚˜ë‹¹ 100 BOK!<br>ëŒ“ê¸€, ì¢‹ì•„ìš”ë¡œ ì¶”ê°€ ìˆ˜ìµ</div></div>
                <div class="feature-card"><div class="feature-icon">ğŸ—ï¸</div><div class="feature-title">ê²Œì‹œíŒ ì†Œìœ </div><div class="feature-desc">ë‚˜ë§Œì˜ ê²Œì‹œíŒ ìš´ì˜<br>ì…ì¥ë£Œ, ìˆ˜ìˆ˜ë£Œ ìˆ˜ìµ</div></div>
                <div class="feature-card"><div class="feature-icon">ğŸ—ºï¸</div><div class="feature-title">ë¶€ë™ì‚° íˆ¬ì</div><div class="feature-desc">ê°€ìƒ ë•… êµ¬ë§¤<br>ëœë¤ ê°€ì¹˜ë¡œ ëŒ€ë°• ì°¬ìŠ¤</div></div>
            </div>
        </div>

        <!-- í™ˆ ì„¹ì…˜ -->
        <div id="homeSection" class="hidden">
            <!-- ì´ˆëŒ€ ì½”ë“œ ì…ë ¥ ë°°ë„ˆ -->
            <div class="invite-banner hidden" id="inviteCodeBanner">
                <div class="invite-banner-text">ğŸ <strong>ì¹œêµ¬ ì´ˆëŒ€ ì½”ë“œ</strong>ê°€ ìˆë‚˜ìš”? ì§€ê¸ˆ ì…ë ¥í•˜ë©´ <strong>+500 BOK</strong>!</div>
                <button class="btn-sm btn-gold" onclick="openModal('profileSettingsModal')">ì…ë ¥í•˜ê¸°</button>
            </div>
            
            <div class="grid-2">
                <!-- ì¼ì¼ ë¯¸ì…˜ -->
                <div class="card relative">
                    <div class="card-header">
                        <h3 class="card-title">ğŸ“‹ ì¼ì¼ ë¯¸ì…˜</h3>
                        <span style="color: var(--text-muted); font-size: 13px;">ë§¤ì¼ ë¦¬ì…‹</span>
                    </div>
                    <div id="missionList">
                        <!-- ìŠ¤ì¼ˆë ˆí†¤ ë¡œë”© -->
                        <div class="mission-item"><div class="skeleton skeleton-circle"></div><div style="flex:1;margin-left:12px;"><div class="skeleton skeleton-text" style="width:60%;"></div><div class="skeleton skeleton-text" style="width:40%;"></div></div></div>
                        <div class="mission-item"><div class="skeleton skeleton-circle"></div><div style="flex:1;margin-left:12px;"><div class="skeleton skeleton-text" style="width:60%;"></div><div class="skeleton skeleton-text" style="width:40%;"></div></div></div>
                    </div>
                    <div class="all-missions-bonus" id="allMissionsBonus">
                        <div style="font-size: 24px; margin-bottom: 8px;">ğŸ</div>
                        <div style="font-weight: 700; margin-bottom: 4px;">ëª¨ë“  ë¯¸ì…˜ ì™„ë£Œ ë³´ë„ˆìŠ¤</div>
                        <div style="color: var(--accent); font-weight: 700; font-size: 18px;">+50 BOK</div>
                        <button class="btn-gold btn-sm hidden" id="claimBonusBtn" onclick="claimMissionBonus()" style="margin-top: 12px;">ë³´ë„ˆìŠ¤ ë°›ê¸°</button>
                    </div>
                </div>
                
                <!-- ì¶œì„ & ë£°ë › -->
                <div class="card relative">
                    <div class="card-header">
                        <h3 class="card-title">ğŸ“… ì¶œì„ ì²´í¬</h3>
                        <span id="streakBadge" class="streak-bonus">ğŸ”¥ ì—°ì† 0ì¼</span>
                    </div>
                    
                    <!-- ë™ê¸°ë¶€ì—¬ ë¬¸êµ¬ -->
                    <div class="motivational-text" id="motivationalText">
                        âœ¨ ì˜¤ëŠ˜ ì²« ì¶œì„í•˜ê³  ë³´ë„ˆìŠ¤ ë°›ìœ¼ì„¸ìš”!
                    </div>
                    
                    <!-- ì¶œì„ ë‹¬ë ¥ -->
                    <div class="calendar-container" id="calendarContainer">
                        <div class="calendar-header">
                            <button class="btn-sm btn-outline" onclick="changeMonth(-1)">â—€</button>
                            <span class="calendar-month" id="calendarMonth">2025ë…„ 12ì›”</span>
                            <button class="btn-sm btn-outline" onclick="changeMonth(1)">â–¶</button>
                        </div>
                        <div class="calendar-grid" id="calendarGrid"></div>
                        <div class="streak-info">
                            <div class="streak-item">
                                <div class="streak-value" id="currentStreak">0</div>
                                <div class="streak-label">ì—°ì† ì¶œì„</div>
                            </div>
                            <div class="streak-item">
                                <div class="streak-value" id="monthlyAttend">0</div>
                                <div class="streak-label">ì´ë²ˆ ë‹¬</div>
                            </div>
                            <div class="streak-item">
                                <div class="streak-value" id="totalAttend">0</div>
                                <div class="streak-label">ì´ ì¶œì„</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ì¶œì„ í˜œíƒ ì¹´ë“œ (ë¡œê·¸ì¸ ì „ìš©) -->
                    <div class="attendance-benefits hidden" id="attendanceBenefits">
                        <h4>ğŸ ì¶œì„ ì²´í¬ í˜œíƒ</h4>
                        <div class="benefit-item">
                            <div class="benefit-icon">ğŸ°</div>
                            <div class="benefit-text">ë§¤ì¼ ë£°ë › ëŒë ¤ì„œ <strong>1~500 BOK</strong> íšë“!</div>
                        </div>
                        <div class="benefit-item">
                            <div class="benefit-icon">ğŸ”¥</div>
                            <div class="benefit-text">7ì¼ ì—°ì† ì¶œì„ ì‹œ <strong>ë³´ìƒ 2ë°°</strong>!</div>
                        </div>
                        <div class="benefit-item">
                            <div class="benefit-icon">ğŸ‘‘</div>
                            <div class="benefit-text">30ì¼ ì—°ì† ì¶œì„ ì‹œ <strong>ë³´ìƒ 3ë°° + íŠ¹ë³„ ì¹­í˜¸</strong>!</div>
                        </div>
                    </div>
                    
                    <!-- ë£°ë › -->
                    <div class="roulette-container" style="margin-top: 20px; border-top: 1px solid var(--border); padding-top: 20px;">
                        <h4 style="margin-bottom: 12px;">ğŸ° ì¶œì„ ë£°ë ›</h4>
                        <div style="position: relative; display: inline-block;">
                            <div class="roulette-pointer">â–¼</div>
                            <div class="roulette-wheel" id="rouletteWheel"></div>
                        </div>
                        <p style="color: var(--text-muted); font-size: 14px; margin: 12px 0;">ë§¤ì¼ 1íšŒ 1~500 BOK!</p>
                        <p id="streakBonusText" style="color: var(--accent); font-size: 13px; margin-bottom: 12px;"></p>
                        <button class="btn-gold btn-block" id="spinBtn" onclick="spinRoulette()">ğŸ² ëŒë¦¬ê¸°</button>
                    </div>
                </div>
            </div>
            
            <div class="grid-2" style="margin-top: 20px;">
                <!-- ì‹¤ì‹œê°„ ì¸ê¸°ê¸€ -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">ğŸ”¥ ì‹¤ì‹œê°„ ì¸ê¸°ê¸€</h3>
                        <span style="color: var(--danger); font-size: 13px;">HOT</span>
                    </div>
                    <div id="hotPostList">
                        <div class="empty-state">
                            <div class="empty-icon">ğŸ”¥</div>
                            <div class="empty-title">ì•„ì§ ì¸ê¸°ê¸€ì´ ì—†ì–´ìš”</div>
                            <div class="empty-desc">ì²« ì¸ê¸°ê¸€ì˜ ì£¼ì¸ê³µì´ ë˜ì–´ë³´ì„¸ìš”!</div>
                            <div class="cta-text" onclick="showSection('boards')">âœï¸ ê¸€ ì“°ëŸ¬ ê°€ê¸°</div>
                        </div>
                    </div>
                </div>
                
                <!-- ì£¼ê°„ ë­í‚¹ -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">ğŸ† ì£¼ê°„ ë­í‚¹</h3>
                        <span style="color: var(--accent); font-size: 13px;">TOP 10 ë³´ìƒ!</span>
                    </div>
                    <div id="rankingList">
                        <div class="empty-state">
                            <div class="empty-icon">ğŸ†</div>
                            <div class="empty-title">ë­í‚¹ ì§‘ê³„ ì¤‘</div>
                            <div class="empty-desc">í™œë™í•˜ê³  ë­í‚¹ì— ì´ë¦„ì„ ì˜¬ë ¤ë³´ì„¸ìš”!</div>
                            <div class="cta-text" onclick="showSection('boards')">ğŸš€ í™œë™ ì‹œì‘í•˜ê¸°</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="grid-2" style="margin-top: 20px;">
                <!-- ë¹ ë¥¸ ì•¡ì…˜ -->
                <div class="card">
                    <div class="card-header"><h3 class="card-title">âš¡ ë¹ ë¥¸ ì•¡ì…˜</h3></div>
                    <button class="btn-primary btn-block" style="margin-bottom: 12px;" onclick="showSection('boards')">ğŸ“ ê¸€ì“°ê¸° (+100 BOK)</button>
                    <button class="btn-pink btn-block" style="margin-bottom: 12px;" onclick="location.href='market.html'">ğŸ—ºï¸ ë¶€ë™ì‚° ë§ˆì¼“</button>
                    <button class="btn-gold btn-block" style="margin-bottom: 12px;" onclick="openModal('createBoardModal')">ğŸ—ï¸ ê²Œì‹œíŒ ë§Œë“¤ê¸°</button>
                    <button class="btn-outline btn-block" style="margin-bottom: 12px;" onclick="openModal('inviteModal')">ğŸ‘¥ ì¹œêµ¬ ì´ˆëŒ€ (+300 BOK)</button>
                    <button class="btn-outline btn-block" onclick="openModal('sendBokModal')">ğŸ’¸ BOK ì†¡ê¸ˆ</button>
                </div>
                
                <!-- ì¸ê¸° ê²Œì‹œíŒ -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">ğŸ”¥ ì¸ê¸° ê²Œì‹œíŒ</h3>
                        <button class="btn-sm btn-outline" onclick="showSection('boards')">ì „ì²´ë³´ê¸°</button>
                    </div>
                    <div id="popularBoards">
                        <div class="empty-state">
                            <div class="empty-icon">ğŸ“‚</div>
                            <div class="empty-title">ê²Œì‹œíŒì´ ì—†ì–´ìš”</div>
                            <div class="empty-desc">ì²« ë²ˆì§¸ ê²Œì‹œíŒì„ ë§Œë“¤ì–´ë³´ì„¸ìš”!</div>
                            <div class="cta-text" onclick="openModal('createBoardModal')">ğŸ—ï¸ ê²Œì‹œíŒ ë§Œë“¤ê¸°</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ê²Œì‹œíŒ ì„¹ì…˜ -->
        <div id="boardsSection" class="hidden">
            <div class="card-header" style="margin-bottom: 20px;">
                <h2 style="font-size: 24px;">ğŸ“‚ ì»¤ë®¤ë‹ˆí‹° ê²Œì‹œíŒ</h2>
                <button class="btn-gold" onclick="openModal('createBoardModal')">+ ê²Œì‹œíŒ ë§Œë“¤ê¸°</button>
            </div>
            <div class="tabs">
                <div class="tab active" onclick="filterBoards('all')">ì „ì²´</div>
                <div class="tab" onclick="filterBoards('my')">ë‚´ ê²Œì‹œíŒ</div>
                <div class="tab" onclick="filterBoards('free')">ë¬´ë£Œ</div>
                <div class="tab" onclick="filterBoards('premium')">í”„ë¦¬ë¯¸ì—„</div>
            </div>
            <div id="boardsList">
                <div class="empty-state" style="padding: 60px;">
                    <div class="empty-icon">ğŸ“‚</div>
                    <div class="empty-title">ì•„ì§ ê²Œì‹œíŒì´ ì—†ì–´ìš”</div>
                    <div class="empty-desc">ì²« ë²ˆì§¸ ê²Œì‹œíŒì˜ ì£¼ì¸ì´ ë˜ì–´ë³´ì„¸ìš”!</div>
                </div>
            </div>
        </div>

        <!-- í”„ë¡œí•„ ì„¹ì…˜ -->
        <div id="profileSection" class="hidden">
            <div class="card">
                <div class="profile-header">
                    <div class="profile-avatar">ğŸ‘¤</div>
                    <div class="profile-info">
                        <div style="display: flex; align-items: center; gap: 8px; flex-wrap: wrap;">
                            <span class="title-badge" id="profileBadge">ğŸŒ± ìƒˆì‹¹</span>
                            <span class="country-flag" id="profileFlag">ğŸŒ</span>
                            <h2 id="profileName" style="margin: 0;">ì‚¬ìš©ì</h2>
                        </div>
                        <div class="profile-stats" style="margin-top: 8px;">
                            <span>ğŸ“ ê¸€ <strong id="profilePosts">0</strong></span>
                            <span>ğŸ’¬ ëŒ“ê¸€ <strong id="profileComments">0</strong></span>
                            <span>ğŸ  ê²Œì‹œíŒ <strong id="profileBoards">0</strong></span>
                        </div>
                    </div>
                    <button class="btn-sm btn-outline" onclick="openModal('profileSettingsModal')">âš™ï¸</button>
                </div>
                
                <!-- ë ˆë²¨ & EXP -->
                <div style="background: var(--bg-dark); padding: 20px; border-radius: 12px; margin-bottom: 20px;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                        <span style="font-weight: 700;">ë ˆë²¨ <span id="currentLevel">1</span></span>
                        <span style="color: var(--text-muted); font-size: 14px;"><span id="currentExp">0</span> / <span id="nextLevelExp">100</span> EXP</span>
                    </div>
                    <div class="progress-bar"><div class="progress-fill" id="expProgress" style="width: 0%;"></div></div>
                </div>
                
                <!-- ìì‚° í˜„í™© -->
                <div class="grid-3">
                    <div style="background: var(--bg-dark); padding: 16px; border-radius: 12px; text-align: center;">
                        <div style="font-size: 24px; font-weight: 900; color: var(--secondary);" id="totalBok">0</div>
                        <div style="font-size: 12px; color: var(--text-muted);">ë³´ìœ  BOK</div>
                    </div>
                    <div style="background: var(--bg-dark); padding: 16px; border-radius: 12px; text-align: center;">
                        <div style="font-size: 24px; font-weight: 900; color: var(--accent);" id="totalEarned">0</div>
                        <div style="font-size: 12px; color: var(--text-muted);">ëˆ„ì  ìˆ˜ìµ</div>
                    </div>
                    <div style="background: var(--bg-dark); padding: 16px; border-radius: 12px; text-align: center;">
                        <div style="font-size: 24px; font-weight: 900; color: var(--pink);" id="totalSpent">0</div>
                        <div style="font-size: 12px; color: var(--text-muted);">ëˆ„ì  ì†Œë¹„</div>
                    </div>
                </div>
                
                <!-- BOK ì†¡ê¸ˆ -->
                <div class="send-bok-section">
                    <h4 style="margin-bottom: 16px;">ğŸ’¸ BOK ì†¡ê¸ˆ</h4>
                    <div style="display: flex; gap: 12px;">
                        <input type="text" id="sendToUser" placeholder="ë°›ëŠ” ì‚¬ëŒ ì´ë¦„ ê²€ìƒ‰" style="flex: 1; margin: 0;" oninput="searchUserForSend(event)">
                        <button class="btn-primary" onclick="openModal('sendBokModal')">ì†¡ê¸ˆ</button>
                    </div>
                    <div id="userSearchResults"></div>
                </div>
            </div>
            
            <!-- ì—…ì  -->
            <div class="card" style="margin-top: 20px;">
                <div class="card-header">
                    <h3 class="card-title">ğŸ… ì—…ì </h3>
                    <span style="color: var(--text-muted); font-size: 13px;" id="achievementCount">0/10 ë‹¬ì„±</span>
                </div>
                <div id="achievementList"></div>
            </div>
        </div>
    </div>

    <!-- ê²Œì‹œíŒ ë§Œë“¤ê¸° ëª¨ë‹¬ -->
    <div class="modal-overlay" id="createBoardModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('createBoardModal')">âœ•</button>
            <h2 class="modal-title">ğŸ—ï¸ ê²Œì‹œíŒ ë§Œë“¤ê¸°</h2>
            <div style="background: rgba(245,158,11,0.1); border: 1px solid rgba(245,158,11,0.3); border-radius: 10px; padding: 14px; margin-bottom: 20px; text-align: center;">
                <span style="color: var(--accent); font-weight: 700; font-size: 18px;">ìƒì„± ë¹„ìš©: 1,000 BOK</span>
            </div>
            <label>ê²Œì‹œíŒ ì´ë¦„</label>
            <input type="text" id="boardName" placeholder="ì˜ˆ: ë¹„íŠ¸ì½”ì¸ íˆ¬ìì ëª¨ì„" maxlength="20">
            <label>ì„¤ëª…</label>
            <textarea id="boardDesc" rows="3" placeholder="ê²Œì‹œíŒì„ ì†Œê°œí•´ì£¼ì„¸ìš”"></textarea>
            <label>ì¹´í…Œê³ ë¦¬</label>
            <select id="boardCategory">
                <option value="general">ğŸ’¬ ììœ </option>
                <option value="investment">ğŸ’° íˆ¬ì</option>
                <option value="game">ğŸ® ê²Œì„</option>
                <option value="tech">ğŸ’» ê¸°ìˆ </option>
                <option value="life">ğŸŒ± ì¼ìƒ</option>
            </select>
            <label>í…Œë§ˆ ìƒ‰ìƒ</label>
            <input type="color" id="boardColor" value="#6366f1" style="height: 50px; padding: 5px;">
            <label>ì•„ì´ì½˜ (ì´ëª¨ì§€)</label>
            <input type="text" id="boardIcon" placeholder="ğŸ“" maxlength="2" style="font-size: 24px; text-align: center;">
            <div style="border-top: 1px solid var(--border); margin: 20px 0; padding-top: 20px;">
                <h4 style="margin-bottom: 12px;">ğŸ’° ìˆ˜ìµí™” ì„¤ì •</h4>
                <label>ì…ì¥ë£Œ (0 = ë¬´ë£Œ)</label>
                <input type="number" id="boardEntryFee" value="0" min="0" max="100">
                <label>ê¸€ì“°ê¸° ìˆ˜ìˆ˜ë£Œ</label>
                <input type="number" id="boardWriteFee" value="0" min="0" max="50">
            </div>
            <div style="border-top: 1px solid var(--border); margin: 20px 0; padding-top: 20px;">
                <h4 style="margin-bottom: 12px;">âš™ï¸ ìš´ì˜ ì„¤ì •</h4>
                <div class="toggle-row"><span>ìŠ¹ì¸ì œ ê²Œì‹œíŒ</span><div class="toggle-switch" id="toggleApproval" onclick="this.classList.toggle('active')"></div></div>
                <div class="toggle-row"><span>ëŒ“ê¸€ í—ˆìš©</span><div class="toggle-switch active" id="toggleComments" onclick="this.classList.toggle('active')"></div></div>
            </div>
            <button class="btn-gold btn-block" onclick="createBoard()">ê²Œì‹œíŒ ìƒì„±í•˜ê¸°</button>
        </div>
    </div>

    <!-- ì¹œêµ¬ ì´ˆëŒ€ ëª¨ë‹¬ -->
    <div class="modal-overlay" id="inviteModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('inviteModal')">âœ•</button>
            <h2 class="modal-title">ğŸ‘¥ ì¹œêµ¬ ì´ˆëŒ€</h2>
            
            <div class="invite-box">
                <p style="color: var(--text-muted); margin-bottom: 8px;">ğŸ“ ì´ˆëŒ€ ë§í¬</p>
                <div style="display: flex; gap: 8px; margin-bottom: 12px;">
                    <input type="text" id="inviteLinkInput" readonly style="flex: 1; margin: 0; font-size: 13px; padding: 10px;">
                    <button class="btn-primary btn-sm" onclick="copyInviteLink()">ë³µì‚¬</button>
                </div>
                <p style="color: var(--text-muted); margin-bottom: 8px;">ğŸ”‘ ì´ˆëŒ€ ì½”ë“œ</p>
                <div style="display: flex; align-items: center; justify-content: center; gap: 12px;">
                    <div class="invite-code" id="myInviteCode">------</div>
                    <button class="btn-outline btn-sm" onclick="copyInviteCode()">ğŸ“‹</button>
                </div>
            </div>
            
            <div style="margin-top: 20px; padding: 20px; background: var(--bg-dark); border-radius: 12px;">
                <h4 style="margin-bottom: 16px; text-align: center;">ğŸ ë‹¨ê³„ë³„ ë¦¬ì›Œë“œ <span style="color: var(--accent);">(ìµœëŒ€ 1,000 BOK)</span></h4>
                <div class="reward-steps">
                    <div class="reward-step">
                        <div class="step-icon">1ï¸âƒ£</div>
                        <div class="step-info">
                            <div class="step-title">ì¹œêµ¬ê°€ ê°€ì…</div>
                            <div class="step-rewards">
                                <span class="reward-tag inviter">ë‚˜ +300</span>
                                <span class="reward-tag invitee">ì¹œêµ¬ +500</span>
                            </div>
                        </div>
                    </div>
                    <div class="reward-step">
                        <div class="step-icon">2ï¸âƒ£</div>
                        <div class="step-info">
                            <div class="step-title">ì¹œêµ¬ê°€ ì²« ê¸€ ì‘ì„±</div>
                            <div class="step-rewards">
                                <span class="reward-tag inviter">ë‚˜ +300</span>
                                <span class="reward-tag invitee">ì¹œêµ¬ +100</span>
                            </div>
                        </div>
                    </div>
                    <div class="reward-step">
                        <div class="step-icon">3ï¸âƒ£</div>
                        <div class="step-info">
                            <div class="step-title">ì¹œêµ¬ê°€ ì²« ë•… êµ¬ë§¤</div>
                            <div class="step-rewards">
                                <span class="reward-tag inviter">ë‚˜ +400</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div style="margin-top: 20px;">
                <h4 style="margin-bottom: 12px;">ğŸ“Š ì´ˆëŒ€ í˜„í™©</h4>
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-bottom: 16px;">
                    <div style="background: var(--bg-dark); padding: 16px; border-radius: 12px; text-align: center;">
                        <div style="font-size: 24px; font-weight: 900; color: var(--secondary);" id="inviteCount">0</div>
                        <div style="font-size: 11px; color: var(--text-muted);">ì´ˆëŒ€í•œ ì¹œêµ¬</div>
                    </div>
                    <div style="background: var(--bg-dark); padding: 16px; border-radius: 12px; text-align: center;">
                        <div style="font-size: 24px; font-weight: 900; color: var(--success);" id="inviteActive">0</div>
                        <div style="font-size: 11px; color: var(--text-muted);">í™œë™ ì¤‘</div>
                    </div>
                    <div style="background: var(--bg-dark); padding: 16px; border-radius: 12px; text-align: center;">
                        <div style="font-size: 24px; font-weight: 900; color: var(--accent);" id="inviteEarned">0</div>
                        <div style="font-size: 11px; color: var(--text-muted);">íšë“ BOK</div>
                    </div>
                </div>
                <div id="invitedFriendsList" style="max-height: 200px; overflow-y: auto;"></div>
            </div>
            
            <div style="margin-top: 20px; padding: 16px; background: linear-gradient(135deg, rgba(245,158,11,0.1), rgba(236,72,153,0.1)); border-radius: 12px; border: 1px solid rgba(245,158,11,0.2);">
                <h4 style="margin-bottom: 12px;">ğŸ† ì´ˆëŒ€ ë§ˆì¼ìŠ¤í†¤</h4>
                <div class="milestone-list">
                    <div class="milestone-item" id="milestone5"><span>ğŸ‘¥ 5ëª…</span><span class="milestone-reward">+500 BOK</span></div>
                    <div class="milestone-item" id="milestone10"><span>ğŸŒŸ 10ëª…</span><span class="milestone-reward">+1,000 BOK</span></div>
                    <div class="milestone-item" id="milestone25"><span>ğŸ’ 25ëª…</span><span class="milestone-reward">+3,000 BOK</span></div>
                    <div class="milestone-item" id="milestone50"><span>ğŸ‘‘ 50ëª…</span><span class="milestone-reward">+10,000 BOK</span></div>
                </div>
            </div>
        </div>
    </div>

    <!-- ë£°ë › ê²°ê³¼ ëª¨ë‹¬ -->
    <div class="modal-overlay" id="rouletteResultModal">
        <div class="modal-content" style="text-align: center;">
            <h2 class="modal-title">ğŸ‰ ì¶•í•˜í•©ë‹ˆë‹¤!</h2>
            <div style="font-size: 48px; margin: 20px 0;">ğŸ°</div>
            <div style="font-size: 36px; font-weight: 900; color: var(--accent); margin-bottom: 10px;">+<span id="rouletteResult">0</span> BOK</div>
            <div id="bonusInfo" style="color: var(--success); font-size: 14px; margin-bottom: 20px;"></div>
            <button class="btn-primary btn-block" onclick="closeModal('rouletteResultModal')">í™•ì¸</button>
        </div>
    </div>

    <!-- BOK ì†¡ê¸ˆ ëª¨ë‹¬ -->
    <div class="modal-overlay" id="sendBokModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('sendBokModal')">âœ•</button>
            <h2 class="modal-title">ğŸ’¸ BOK ì†¡ê¸ˆ</h2>
            
            <label>ë°›ëŠ” ì‚¬ëŒ</label>
            <input type="text" id="sendRecipient" placeholder="ì´ë¦„ ë˜ëŠ” ì´ë©”ì¼ë¡œ ê²€ìƒ‰" oninput="searchRecipient(event)">
            <div id="recipientResults" style="margin-bottom: 12px;"></div>
            
            <div id="selectedRecipient" style="display: none; background: var(--bg-dark); padding: 12px; border-radius: 10px; margin-bottom: 12px;">
                <div style="display: flex; align-items: center; gap: 12px;">
                    <div style="width: 40px; height: 40px; background: var(--gradient-primary); border-radius: 50%; display: flex; align-items: center; justify-content: center;">ğŸ‘¤</div>
                    <div>
                        <div id="recipientName" style="font-weight: 600;"></div>
                        <div id="recipientEmail" style="font-size: 12px; color: var(--text-muted);"></div>
                    </div>
                    <button class="btn-sm btn-outline" onclick="clearRecipient()" style="margin-left: auto;">âœ•</button>
                </div>
            </div>
            
            <label>ë³´ë‚¼ ê¸ˆì•¡</label>
            <input type="number" id="sendAmount" placeholder="BOK ë‹¨ìœ„" min="1">
            <p style="font-size: 12px; color: var(--text-muted); margin-bottom: 16px;">ğŸ’¡ ìˆ˜ìˆ˜ë£Œ ì—†ì´ ì¦‰ì‹œ ì „ì†¡ë©ë‹ˆë‹¤</p>
            
            <button class="btn-gold btn-block" onclick="sendBok()">ì†¡ê¸ˆí•˜ê¸°</button>
        </div>
    </div>

    <!-- í”„ë¡œí•„ ì„¤ì • ëª¨ë‹¬ -->
    <div class="modal-overlay" id="profileSettingsModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('profileSettingsModal')">âœ•</button>
            <h2 class="modal-title">âš™ï¸ í”„ë¡œí•„ ì„¤ì •</h2>
            
            <div id="inviteCodeEntrySection" style="display: none; margin-bottom: 20px; padding: 16px; background: linear-gradient(135deg, rgba(99,102,241,0.1), rgba(236,72,153,0.1)); border: 1px solid rgba(99,102,241,0.3); border-radius: 12px;">
                <h4 style="margin-bottom: 8px;">ğŸ ì´ˆëŒ€ ì½”ë“œ ì…ë ¥</h4>
                <p style="font-size: 12px; color: var(--text-muted); margin-bottom: 12px;">ê°€ì… 7ì¼ ë‚´ ì…ë ¥ ê°€ëŠ¥! ì…ë ¥ ì‹œ <strong style="color: var(--success);">+500 BOK</strong></p>
                <div style="display: flex; gap: 8px;">
                    <input type="text" id="enterInviteCode" placeholder="ì´ˆëŒ€ ì½”ë“œ ì…ë ¥" style="flex: 1; margin: 0; text-transform: uppercase;">
                    <button class="btn-gold" onclick="applyInviteCode()">ì ìš©</button>
                </div>
                <p id="inviteCodeDaysLeft" style="font-size: 11px; color: var(--accent); margin-top: 8px; text-align: center;"></p>
            </div>
            
            <label>ğŸŒ êµ­ê°€ ì„ íƒ</label>
            <select id="countrySelect">
                <option value="ğŸŒ">ğŸŒ ë¯¸ì„¤ì •</option>
                <option value="ğŸ‡°ğŸ‡·">ğŸ‡°ğŸ‡· í•œêµ­</option>
                <option value="ğŸ‡ºğŸ‡¸">ğŸ‡ºğŸ‡¸ ë¯¸êµ­</option>
                <option value="ğŸ‡¯ğŸ‡µ">ğŸ‡¯ğŸ‡µ ì¼ë³¸</option>
                <option value="ğŸ‡¨ğŸ‡³">ğŸ‡¨ğŸ‡³ ì¤‘êµ­</option>
                <option value="ğŸ‡¬ğŸ‡§">ğŸ‡¬ğŸ‡§ ì˜êµ­</option>
                <option value="ğŸ‡©ğŸ‡ª">ğŸ‡©ğŸ‡ª ë…ì¼</option>
                <option value="ğŸ‡«ğŸ‡·">ğŸ‡«ğŸ‡· í”„ë‘ìŠ¤</option>
                <option value="ğŸ‡ªğŸ‡¸">ğŸ‡ªğŸ‡¸ ìŠ¤í˜ì¸</option>
                <option value="ğŸ‡®ğŸ‡¹">ğŸ‡®ğŸ‡¹ ì´íƒˆë¦¬ì•„</option>
                <option value="ğŸ‡§ğŸ‡·">ğŸ‡§ğŸ‡· ë¸Œë¼ì§ˆ</option>
                <option value="ğŸ‡¨ğŸ‡¦">ğŸ‡¨ğŸ‡¦ ìºë‚˜ë‹¤</option>
                <option value="ğŸ‡¦ğŸ‡º">ğŸ‡¦ğŸ‡º í˜¸ì£¼</option>
            </select>
            
            <label style="margin-top: 16px;">ğŸ… ëŒ€í‘œ ì¹­í˜¸ ì„ íƒ</label>
            <p style="font-size: 12px; color: var(--text-muted); margin-bottom: 12px;">ë‹¬ì„±í•œ ì—…ì ì˜ ì¹­í˜¸ë¥¼ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤</p>
            <div id="titleSelectList" style="display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 20px;"></div>
            
            <button class="btn-primary btn-block" onclick="saveProfileSettings()">ì €ì¥í•˜ê¸°</button>
            
            <div style="border-top: 1px solid var(--border); margin-top: 24px; padding-top: 20px;">
                <button class="btn-outline btn-block" style="color: var(--danger); border-color: var(--danger);" onclick="logout()">ğŸšª ë¡œê·¸ì•„ì›ƒ</button>
            </div>
        </div>
    </div>

    <!-- PWA ë§¤ë‹ˆí˜ìŠ¤íŠ¸ ì¸ë¼ì¸ ìƒì„± -->
    <script>
        // ë§¤ë‹ˆí˜ìŠ¤íŠ¸ ë™ì  ìƒì„±
        const manifest = {
            name: "BOKLUCK",
            short_name: "BOKLUCK",
            description: "ê¸€ ì“°ê³  ë•… ì‚¬ëŠ” Web3 ì»¤ë®¤ë‹ˆí‹°",
            start_url: "/",
            display: "standalone",
            background_color: "#0a0a0f",
            theme_color: "#6366f1",
            icons: [
                { src: "data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ°</text></svg>", sizes: "any", type: "image/svg+xml" }
            ]
        };
        const blob = new Blob([JSON.stringify(manifest)], {type: 'application/json'});
        const manifestURL = URL.createObjectURL(blob);
        document.querySelector('link[rel="manifest"]')?.setAttribute('href', manifestURL);
    </script>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
        import { getFirestore, collection, doc, setDoc, getDoc, getDocs, updateDoc, onSnapshot, query, orderBy, where, increment, runTransaction, limit, addDoc, deleteDoc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";
        import { getAuth, signInWithPopup, GoogleAuthProvider, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";

        const firebaseConfig = { apiKey: "AIzaSyBwQjuqgWM4YKnqu_gzNbeCg5alrC-jVcQ", authDomain: "myco-737a0.firebaseapp.com", projectId: "myco-737a0", storageBucket: "myco-737a0.firebasestorage.app", messagingSenderId: "942571332540", appId: "1:942571332540:web:be0bb6fbdd32655501c1b9" };
        
        let app, db, auth;
        let currentUser = null, userData = null;
        let currentCalendarDate = new Date();
        let selectedRecipientUid = null;
        let currentOnboardingStep = 1;
        let deferredPrompt = null;

        // ì—ëŸ¬ í•¸ë“¤ë§
        try {
            app = initializeApp(firebaseConfig);
            db = getFirestore(app);
            auth = getAuth(app);
        } catch(e) {
            console.error("Firebase ì´ˆê¸°í™” ì‹¤íŒ¨:", e);
            document.getElementById("loadingOverlay").classList.add("fade-out");
            document.getElementById("errorContainer").classList.remove("hidden");
            document.getElementById("authSection").classList.add("hidden");
        }

        // ë¡œë”© ì™„ë£Œ
        window.addEventListener('load', () => {
            setTimeout(() => {
                document.getElementById("loadingOverlay").classList.add("fade-out");
            }, 500);
        });

        // ë‹¤í¬/ë¼ì´íŠ¸ ëª¨ë“œ
        window.toggleTheme = function() {
            const current = document.documentElement.getAttribute('data-theme');
            const newTheme = current === 'light' ? 'dark' : 'light';
            document.documentElement.setAttribute('data-theme', newTheme);
            document.getElementById('themeToggle').textContent = newTheme === 'light' ? 'â˜€ï¸' : 'ğŸŒ™';
            localStorage.setItem('theme', newTheme);
        };

        // ì €ì¥ëœ í…Œë§ˆ ì ìš©
        const savedTheme = localStorage.getItem('theme') || 'dark';
        document.documentElement.setAttribute('data-theme', savedTheme);
        document.getElementById('themeToggle').textContent = savedTheme === 'light' ? 'â˜€ï¸' : 'ğŸŒ™';

        // PWA ì„¤ì¹˜ í”„ë¡¬í”„íŠ¸
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            // 3ì´ˆ í›„ ë°°ë„ˆ í‘œì‹œ
            setTimeout(() => {
                if(!localStorage.getItem('pwa-dismissed')) {
                    document.getElementById('pwaInstallBanner').classList.add('show');
                }
            }, 3000);
        });

        window.installPwa = async function() {
            if(!deferredPrompt) return;
            deferredPrompt.prompt();
            const { outcome } = await deferredPrompt.userChoice;
            deferredPrompt = null;
            document.getElementById('pwaInstallBanner').classList.remove('show');
        };

        window.dismissPwaBanner = function() {
            document.getElementById('pwaInstallBanner').classList.remove('show');
            localStorage.setItem('pwa-dismissed', 'true');
        };

        // ì˜¨ë³´ë”©
        window.nextOnboardingStep = function() {
            if(currentOnboardingStep >= 3) {
                skipOnboarding();
                return;
            }
            document.querySelector(`.onboarding-step[data-step="${currentOnboardingStep}"]`).classList.remove('active');
            document.querySelector(`.onboarding-dot[data-dot="${currentOnboardingStep}"]`).classList.remove('active');
            currentOnboardingStep++;
            document.querySelector(`.onboarding-step[data-step="${currentOnboardingStep}"]`).classList.add('active');
            document.querySelector(`.onboarding-dot[data-dot="${currentOnboardingStep}"]`).classList.add('active');
            
            if(currentOnboardingStep === 3) {
                document.getElementById('onboardingBtnText').textContent = 'ì‹œì‘í•˜ê¸°!';
            }
        };

        window.skipOnboarding = function() {
            document.getElementById('onboardingOverlay').style.display = 'none';
            localStorage.setItem('onboarding-done', 'true');
        };

        // í†µê³„ ë¡œë“œ
        async function loadStats() {
            try {
                const [users, posts, lands] = await Promise.all([getDocs(collection(db, "users")), getDocs(collection(db, "posts")), getDocs(collection(db, "lands"))]);
                document.getElementById("statUsers").textContent = users.size || '0';
                document.getElementById("statPosts").textContent = posts.size || '0';
                document.getElementById("statLands").textContent = lands.size || '0';
            } catch(e) { 
                console.log(e);
                document.getElementById("statUsers").textContent = '0';
                document.getElementById("statPosts").textContent = '0';
                document.getElementById("statLands").textContent = '0';
            }
        }
        loadStats();

        // ë¡œê·¸ì¸
        document.getElementById("loginBtn")?.addEventListener("click", async () => {
            try { 
                await signInWithPopup(auth, new GoogleAuthProvider()); 
                // ì˜¨ë³´ë”© í‘œì‹œ
                if(!localStorage.getItem('onboarding-done')) {
                    document.getElementById('onboardingOverlay').style.display = 'flex';
                }
            } catch(e) { console.log(e); }
        });

        // URLì—ì„œ ì´ˆëŒ€ ì½”ë“œ í™•ì¸
        const urlParams = new URLSearchParams(window.location.search);
        const refCode = urlParams.get('ref');
        if(refCode) document.getElementById("inviteCodeInput").value = refCode;

        // ì¸ì¦ ìƒíƒœ
        onAuthStateChanged(auth, async (user) => {
            if(user) {
                currentUser = user;
                document.getElementById("authSection").classList.add("hidden");
                document.getElementById("homeSection").classList.remove("hidden");
                document.getElementById("searchContainer").style.display = "block";
                document.getElementById("calendarContainer").classList.remove("hidden");
                document.getElementById("attendanceBenefits").classList.add("hidden");
                
                const userRef = doc(db, "users", user.uid);
                onSnapshot(userRef, async (docSnap) => {
                    if(!docSnap.exists()) {
                        // ìƒˆ ì‚¬ìš©ì ìƒì„±
                        const inviteCode = Math.random().toString(36).substring(2, 8).toUpperCase();
                        const inputCode = document.getElementById("inviteCodeInput").value.trim().toUpperCase() || refCode?.toUpperCase();
                        
                        let inviterUid = null;
                        if(inputCode) {
                            const inviterQuery = query(collection(db, "users"), where("inviteCode", "==", inputCode));
                            const inviterSnap = await getDocs(inviterQuery);
                            if(!inviterSnap.empty) {
                                const inviterDoc = inviterSnap.docs[0];
                                inviterUid = inviterDoc.id;
                                await updateDoc(doc(db, "users", inviterUid), { 
                                    coin: increment(300), totalEarned: increment(300),
                                    inviteCount: increment(1), inviteRewards: increment(300)
                                });
                                await addDoc(collection(db, "invites"), {
                                    inviterUid, inviteeUid: user.uid, inviteeName: user.displayName,
                                    stage1: true, stage2: false, stage3: false,
                                    stage1At: new Date().toISOString(), createdAt: new Date().toISOString()
                                });
                                await addDoc(collection(db, "notifications"), {
                                    userId: inviterUid, type: 'invite', title: 'ì¹œêµ¬ ê°€ì…',
                                    message: `${user.displayName}ë‹˜ì´ ê°€ì…í–ˆìŠµë‹ˆë‹¤! +300 BOK`,
                                    read: false, createdAt: new Date().toISOString()
                                });
                            }
                        }
                        
                        await setDoc(userRef, { 
                            name: user.displayName, email: user.email,
                            coin: 500 + (inviterUid ? 500 : 0), exp: 0, level: 1,
                            totalEarned: 500 + (inviterUid ? 500 : 0), totalSpent: 0,
                            postCount: 0, commentCount: 0, landCount: 0, boardCount: 0,
                            inviteCode, inviteCount: 0, inviteRewards: 0,
                            invitedBy: inviterUid || null, inviteCodeUsed: !!inviterUid,
                            lastRoulette: null, streak: 0, totalAttendance: 0,
                            attendanceDates: [], missionBonusClaimed: null,
                            createdAt: new Date().toISOString()
                        });
                        
                        if(inviterUid) alert("ğŸ‰ ì´ˆëŒ€ ì½”ë“œ ì ìš©! +500 BOK ë³´ë„ˆìŠ¤!");
                        
                        // ì‹ ê·œ ìœ ì € ì˜¨ë³´ë”©
                        if(!localStorage.getItem('onboarding-done')) {
                            document.getElementById('onboardingOverlay').style.display = 'flex';
                        }
                    }
                    userData = docSnap.data();
                    updateUI();
                    loadMissions();
                    loadCalendar();
                    checkInviteCodeBanner();
                    loadInvitedFriends();
                    loadAchievements();
                });
                
                loadBoards();
                loadRanking();
                loadHotPosts();
                loadNotifications();
            } else {
                document.getElementById("authSection").classList.remove("hidden");
                document.getElementById("homeSection").classList.add("hidden");
                document.getElementById("boardsSection").classList.add("hidden");
                document.getElementById("profileSection").classList.add("hidden");
                document.getElementById("searchContainer").style.display = "none";
                // ë¡œê·¸ì¸ ì „ ì¶œì„ í˜œíƒ ì¹´ë“œ í‘œì‹œ
                document.getElementById("calendarContainer").classList.add("hidden");
                document.getElementById("attendanceBenefits").classList.remove("hidden");
            }
        });

        // UI ì—…ë°ì´íŠ¸
        function updateUI() {
            if(!userData) return;
            document.getElementById("walletBadge").innerHTML = `ğŸ’° ${(userData.coin||0).toLocaleString()} BOK`;
            document.getElementById("levelBadge").textContent = `Lv.${userData.level||1}`;
            document.getElementById("currentLevel").textContent = userData.level||1;
            const exp = userData.exp||0, nextExp = (userData.level||1)*100;
            document.getElementById("currentExp").textContent = exp;
            document.getElementById("nextLevelExp").textContent = nextExp;
            document.getElementById("expProgress").style.width = `${(exp/nextExp)*100}%`;
            document.getElementById("profileName").textContent = userData.name||"ì‚¬ìš©ì";
            document.getElementById("profilePosts").textContent = userData.postCount||0;
            document.getElementById("profileComments").textContent = userData.commentCount||0;
            document.getElementById("totalBok").textContent = (userData.coin||0).toLocaleString();
            document.getElementById("totalEarned").textContent = (userData.totalEarned||0).toLocaleString();
            document.getElementById("totalSpent").textContent = (userData.totalSpent||0).toLocaleString();
            document.getElementById("myInviteCode").textContent = userData.inviteCode||"------";
            document.getElementById("inviteCount").textContent = userData.inviteCount||0;
            document.getElementById("inviteEarned").textContent = (userData.inviteRewards||0).toLocaleString();
            
            const baseUrl = window.location.origin + window.location.pathname;
            document.getElementById("inviteLinkInput").value = `${baseUrl}?ref=${userData.inviteCode||''}`;
            
            const count = userData.inviteCount || 0;
            if(count >= 5) document.getElementById("milestone5").classList.add("achieved");
            if(count >= 10) document.getElementById("milestone10").classList.add("achieved");
            if(count >= 25) document.getElementById("milestone25").classList.add("achieved");
            if(count >= 50) document.getElementById("milestone50").classList.add("achieved");
            
            document.getElementById("profileFlag").textContent = userData.country || "ğŸŒ";
            document.getElementById("profileBadge").textContent = userData.title || "ğŸŒ± ìƒˆì‹¹";
            document.getElementById("countrySelect").value = userData.country || "ğŸŒ";
            
            const streak = userData.streak || 0;
            document.getElementById("currentStreak").textContent = streak;
            document.getElementById("streakBadge").textContent = `ğŸ”¥ ì—°ì† ${streak}ì¼`;
            document.getElementById("totalAttend").textContent = userData.totalAttendance || 0;
            
            // ë™ê¸°ë¶€ì—¬ ë¬¸êµ¬ ì—…ë°ì´íŠ¸
            let motivText = "âœ¨ ì˜¤ëŠ˜ ì²« ì¶œì„í•˜ê³  ë³´ë„ˆìŠ¤ ë°›ìœ¼ì„¸ìš”!";
            if(streak >= 30) motivText = "ğŸ† 30ì¼ ì—°ì† ë‹¬ì„±! ë³´ìƒ 3ë°° ì ìš© ì¤‘!";
            else if(streak >= 7) motivText = "ğŸ”¥ 7ì¼ ì—°ì† ë‹¬ì„±! ë³´ìƒ 2ë°° ì ìš© ì¤‘!";
            else if(streak >= 3) motivText = `ğŸ’ª ${streak}ì¼ ì—°ì† ì¶œì„ ì¤‘! 7ì¼ê¹Œì§€ ${7-streak}ì¼!`;
            else if(streak > 0) motivText = `ğŸ‘ ${streak}ì¼ ì—°ì† ì¶œì„! ê³„ì† ì´ì–´ê°€ì„¸ìš”!`;
            document.getElementById("motivationalText").textContent = motivText;
            
            let bonusText = "";
            if(streak >= 30) bonusText = "ğŸ”¥ 30ì¼ ì—°ì†! ë³´ìƒ 3ë°°!";
            else if(streak >= 7) bonusText = "ğŸ”¥ 7ì¼ ì—°ì†! ë³´ìƒ 2ë°°!";
            document.getElementById("streakBonusText").textContent = bonusText;
            
            updateTitleOptions();
            document.getElementById("logoutBtn").classList.remove("hidden");
            
            const lastRoulette = userData.lastRoulette;
            if(lastRoulette && new Date(lastRoulette).toDateString() === new Date().toDateString()) {
                document.getElementById("spinBtn").disabled = true;
                document.getElementById("spinBtn").textContent = "âœ… ì™„ë£Œ";
            } else {
                document.getElementById("spinBtn").disabled = false;
                document.getElementById("spinBtn").textContent = "ğŸ² ëŒë¦¬ê¸°";
            }
        }

        // ë¯¸ì…˜ ë¡œë“œ
        function loadMissions() {
            if(!userData) return;
            const today = new Date().toDateString();
            const missions = userData.missions || {};
            const todayMissions = missions[today] || { posts: 0, comments: 0, likes: 0, visits: 0 };
            
            const missionData = [
                { icon: 'âœï¸', title: 'ê¸€ì“°ê¸° 1íšŒ', current: todayMissions.posts || 0, target: 1, reward: 100 },
                { icon: 'ğŸ’¬', title: 'ëŒ“ê¸€ 3ê°œ', current: todayMissions.comments || 0, target: 3, reward: 30 },
                { icon: 'â¤ï¸', title: 'ì¢‹ì•„ìš” 5ê°œ', current: todayMissions.likes || 0, target: 5, reward: 10 },
                { icon: 'ğŸ ', title: 'ê²Œì‹œíŒ 3ê³³ ë°©ë¬¸', current: todayMissions.visits || 0, target: 3, reward: 20 }
            ];
            
            const list = document.getElementById("missionList");
            list.innerHTML = "";
            let allCompleted = true;
            
            missionData.forEach(m => {
                const completed = m.current >= m.target;
                if(!completed) allCompleted = false;
                
                list.innerHTML += `
                    <div class="mission-item ${completed ? 'completed' : ''}">
                        <div class="mission-info">
                            <div class="mission-icon">${m.icon}</div>
                            <div>
                                <div class="mission-title">${m.title}</div>
                                <div class="mission-progress">${Math.min(m.current, m.target)}/${m.target}</div>
                            </div>
                        </div>
                        ${completed ? '<span class="mission-complete-badge">âœ“ ì™„ë£Œ</span>' : `<span class="mission-reward">+${m.reward} BOK</span>`}
                    </div>
                `;
            });
            
            const bonusSection = document.getElementById("allMissionsBonus");
            const bonusClaimed = userData.missionBonusClaimed === today;
            
            if(allCompleted && !bonusClaimed) {
                bonusSection.classList.add("claimable");
                document.getElementById("claimBonusBtn").classList.remove("hidden");
            } else {
                bonusSection.classList.remove("claimable");
                document.getElementById("claimBonusBtn").classList.add("hidden");
                if(bonusClaimed) {
                    bonusSection.innerHTML = `<div style="color: var(--success);">âœ… ë³´ë„ˆìŠ¤ ìˆ˜ë ¹ ì™„ë£Œ!</div>`;
                }
            }
        }

        window.claimMissionBonus = async function() {
            if(!currentUser) return;
            const today = new Date().toDateString();
            await updateDoc(doc(db, "users", currentUser.uid), {
                coin: increment(50), totalEarned: increment(50), missionBonusClaimed: today
            });
            alert("ğŸ ë¯¸ì…˜ ì™„ë£Œ ë³´ë„ˆìŠ¤ +50 BOK!");
        };

        // ì¶œì„ ë‹¬ë ¥ - í˜„ì¬ ë‚ ì§œ ê¸°ì¤€ìœ¼ë¡œ ìˆ˜ì •
        function loadCalendar() {
            if(!userData) return;
            const year = currentCalendarDate.getFullYear();
            const month = currentCalendarDate.getMonth();
            
            document.getElementById("calendarMonth").textContent = `${year}ë…„ ${month + 1}ì›”`;
            
            const firstDay = new Date(year, month, 1).getDay();
            const lastDate = new Date(year, month + 1, 0).getDate();
            const today = new Date();
            const attendDates = userData.attendanceDates || [];
            
            const grid = document.getElementById("calendarGrid");
            grid.innerHTML = "";
            
            ['ì¼','ì›”','í™”','ìˆ˜','ëª©','ê¸ˆ','í† '].forEach(d => {
                grid.innerHTML += `<div class="calendar-day-header">${d}</div>`;
            });
            
            for(let i = 0; i < firstDay; i++) {
                grid.innerHTML += `<div class="calendar-day"></div>`;
            }
            
            let monthlyCount = 0;
            for(let d = 1; d <= lastDate; d++) {
                const dateStr = `${year}-${String(month+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
                const isToday = today.getFullYear() === year && today.getMonth() === month && today.getDate() === d;
                const isFuture = new Date(year, month, d) > today;
                const attended = attendDates.includes(dateStr);
                if(attended) monthlyCount++;
                
                let cls = "calendar-day";
                if(isToday) cls += " today";
                if(attended) cls += " attended";
                if(isFuture) cls += " future";
                
                grid.innerHTML += `<div class="${cls}">${d}</div>`;
            }
            
            document.getElementById("monthlyAttend").textContent = monthlyCount;
        }

        window.changeMonth = function(delta) {
            currentCalendarDate.setMonth(currentCalendarDate.getMonth() + delta);
            loadCalendar();
        };

        // ë£°ë ›
        window.spinRoulette = async function() {
            if(!currentUser || !userData) return;
            const lastRoulette = userData.lastRoulette;
            if(lastRoulette && new Date(lastRoulette).toDateString() === new Date().toDateString()) return alert("ì˜¤ëŠ˜ ì´ë¯¸ ì™„ë£Œ!");
            
            const btn = document.getElementById("spinBtn");
            btn.disabled = true;
            const wheel = document.getElementById("rouletteWheel");
            wheel.style.transform = `rotate(${1800 + Math.random() * 360}deg)`;
            
            const rand = Math.random();
            let reward;
            if(rand < 0.5) reward = Math.floor(Math.random() * 50) + 1;
            else if(rand < 0.8) reward = Math.floor(Math.random() * 100) + 50;
            else if(rand < 0.95) reward = Math.floor(Math.random() * 150) + 150;
            else reward = Math.floor(Math.random() * 200) + 300;
            
            const streak = userData.streak || 0;
            let multiplier = 1;
            let bonusInfo = "";
            if(streak >= 30) { multiplier = 3; bonusInfo = "ğŸ”¥ 30ì¼ ì—°ì† ë³´ë„ˆìŠ¤ x3!"; }
            else if(streak >= 7) { multiplier = 2; bonusInfo = "ğŸ”¥ 7ì¼ ì—°ì† ë³´ë„ˆìŠ¤ x2!"; }
            
            reward *= multiplier;
            
            const today = new Date().toISOString().split('T')[0];
            const yesterday = new Date(Date.now() - 86400000).toISOString().split('T')[0];
            const attendDates = userData.attendanceDates || [];
            const wasYesterdayAttend = attendDates.includes(yesterday);
            const newStreak = wasYesterdayAttend ? (streak + 1) : 1;
            
            setTimeout(async () => {
                await updateDoc(doc(db, "users", currentUser.uid), { 
                    coin: increment(reward), totalEarned: increment(reward), 
                    lastRoulette: new Date().toISOString(),
                    streak: newStreak, totalAttendance: increment(1),
                    attendanceDates: [...attendDates.filter(d => d > new Date(Date.now() - 90*86400000).toISOString().split('T')[0]), today]
                });
                document.getElementById("rouletteResult").textContent = reward;
                document.getElementById("bonusInfo").textContent = bonusInfo;
                openModal('rouletteResultModal');
                btn.textContent = "âœ… ì™„ë£Œ";
            }, 3000);
        };

        // ì‹¤ì‹œê°„ ì¸ê¸°ê¸€
        async function loadHotPosts() {
            const q = query(collection(db, "posts"), orderBy("likeCount", "desc"), limit(5));
            onSnapshot(q, (snapshot) => {
                const list = document.getElementById("hotPostList");
                if(snapshot.empty) {
                    list.innerHTML = `<div class="empty-state">
                        <div class="empty-icon">ğŸ”¥</div>
                        <div class="empty-title">ì•„ì§ ì¸ê¸°ê¸€ì´ ì—†ì–´ìš”</div>
                        <div class="empty-desc">ì²« ì¸ê¸°ê¸€ì˜ ì£¼ì¸ê³µì´ ë˜ì–´ë³´ì„¸ìš”!</div>
                        <div class="cta-text" onclick="showSection('boards')">âœï¸ ê¸€ ì“°ëŸ¬ ê°€ê¸°</div>
                    </div>`;
                    return;
                }
                list.innerHTML = "";
                let rank = 1;
                snapshot.forEach(docSnap => {
                    const p = docSnap.data();
                    list.innerHTML += `
                        <div class="hot-post-item" onclick="location.href='board.html?id=${p.boardId}'">
                            <div class="hot-rank">${rank}</div>
                            <div class="hot-post-info">
                                <div class="hot-post-title">${p.title}</div>
                                <div class="hot-post-meta">${p.authorName} Â· ${new Date(p.createdAt).toLocaleDateString()}</div>
                            </div>
                            <div class="hot-post-stats">â¤ï¸ ${p.likeCount || 0}</div>
                        </div>
                    `;
                    rank++;
                });
            });
        }

        // ì•Œë¦¼
        function loadNotifications() {
            if(!currentUser) return;
            const q = query(collection(db, "notifications"), where("userId", "==", currentUser.uid), orderBy("createdAt", "desc"), limit(20));
            onSnapshot(q, (snapshot) => {
                const list = document.getElementById("notificationList");
                const badge = document.getElementById("notifBadge");
                let unreadCount = 0;
                
                list.innerHTML = "";
                if(snapshot.empty) {
                    list.innerHTML = '<div style="padding: 40px; text-align: center; color: var(--text-muted);">ì•Œë¦¼ì´ ì—†ìŠµë‹ˆë‹¤</div>';
                    badge.classList.add("hidden");
                    return;
                }
                
                snapshot.forEach(docSnap => {
                    const n = docSnap.data();
                    if(!n.read) unreadCount++;
                    
                    const icons = { invite: 'ğŸ‘¥', like: 'â¤ï¸', comment: 'ğŸ’¬', bok: 'ğŸ’°', land: 'ğŸ ', system: 'ğŸ“¢' };
                    list.innerHTML += `
                        <div class="notification-item ${n.read ? '' : 'unread'}" onclick="markNotifRead('${docSnap.id}')">
                            <span class="notification-icon">${icons[n.type] || 'ğŸ“Œ'}</span>
                            <div>
                                <div class="notification-text"><strong>${n.title}</strong><br>${n.message}</div>
                                <div class="notification-time">${timeAgo(n.createdAt)}</div>
                            </div>
                        </div>
                    `;
                });
                
                if(unreadCount > 0) {
                    badge.textContent = unreadCount;
                    badge.classList.remove("hidden");
                } else {
                    badge.classList.add("hidden");
                }
            });
        }

        window.markNotifRead = async function(id) {
            await updateDoc(doc(db, "notifications", id), { read: true });
        };

        window.markAllRead = async function(e) {
            e.stopPropagation();
            const q = query(collection(db, "notifications"), where("userId", "==", currentUser.uid), where("read", "==", false));
            const snapshot = await getDocs(q);
            snapshot.forEach(async docSnap => {
                await updateDoc(docSnap.ref, { read: true });
            });
        };

        function timeAgo(dateStr) {
            const diff = Date.now() - new Date(dateStr).getTime();
            const mins = Math.floor(diff / 60000);
            if(mins < 1) return 'ë°©ê¸ˆ ì „';
            if(mins < 60) return `${mins}ë¶„ ì „`;
            const hours = Math.floor(mins / 60);
            if(hours < 24) return `${hours}ì‹œê°„ ì „`;
            return `${Math.floor(hours / 24)}ì¼ ì „`;
        }

        window.toggleNotifications = function() {
            document.getElementById("notificationDropdown").classList.toggle("active");
        };

        // ê²€ìƒ‰
        window.handleSearch = async function(e) {
            const query = e.target.value.trim().toLowerCase();
            const results = document.getElementById("searchResults");
            
            if(query.length < 2) { results.innerHTML = ""; return; }
            
            results.innerHTML = '<div style="padding: 20px; text-align: center; color: var(--text-muted);">ê²€ìƒ‰ ì¤‘...</div>';
            
            try {
                const boardsSnap = await getDocs(collection(db, "boards"));
                const postsSnap = await getDocs(collection(db, "posts"));
                const usersSnap = await getDocs(collection(db, "users"));
                
                let html = "";
                
                boardsSnap.forEach(docSnap => {
                    const b = docSnap.data();
                    if(b.name.toLowerCase().includes(query)) {
                        html += `<div class="search-result-item" onclick="location.href='board.html?id=${docSnap.id}'">${b.icon||'ğŸ“'} ${b.name} <span style="color: var(--text-muted); font-size: 12px;">ê²Œì‹œíŒ</span></div>`;
                    }
                });
                
                postsSnap.forEach(docSnap => {
                    const p = docSnap.data();
                    if(p.title.toLowerCase().includes(query)) {
                        html += `<div class="search-result-item" onclick="location.href='board.html?id=${p.boardId}'">ğŸ“„ ${p.title} <span style="color: var(--text-muted); font-size: 12px;">ê¸€</span></div>`;
                    }
                });
                
                usersSnap.forEach(docSnap => {
                    const u = docSnap.data();
                    if(u.name && u.name.toLowerCase().includes(query)) {
                        html += `<div class="search-result-item">ğŸ‘¤ ${u.name} <span style="color: var(--text-muted); font-size: 12px;">ì‚¬ìš©ì</span></div>`;
                    }
                });
                
                results.innerHTML = html || '<div style="padding: 20px; text-align: center; color: var(--text-muted);">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤</div>';
            } catch(e) { console.log(e); }
        };

        // BOK ì†¡ê¸ˆ
        window.searchRecipient = async function(e) {
            const query = e.target.value.trim().toLowerCase();
            const results = document.getElementById("recipientResults");
            
            if(query.length < 2) { results.innerHTML = ""; return; }
            
            const usersSnap = await getDocs(collection(db, "users"));
            let html = "";
            
            usersSnap.forEach(docSnap => {
                const u = docSnap.data();
                if(docSnap.id !== currentUser.uid && u.name && u.name.toLowerCase().includes(query)) {
                    html += `<div class="user-search-result" onclick="selectRecipient('${docSnap.id}', '${u.name}', '${u.email}')">${u.country||''} ${u.name}</div>`;
                }
            });
            
            results.innerHTML = html || '<div style="padding: 12px; color: var(--text-muted); font-size: 13px;">ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤</div>';
        };

        window.selectRecipient = function(uid, name, email) {
            selectedRecipientUid = uid;
            document.getElementById("recipientName").textContent = name;
            document.getElementById("recipientEmail").textContent = email;
            document.getElementById("selectedRecipient").style.display = "block";
            document.getElementById("recipientResults").innerHTML = "";
            document.getElementById("sendRecipient").value = "";
        };

        window.clearRecipient = function() {
            selectedRecipientUid = null;
            document.getElementById("selectedRecipient").style.display = "none";
        };

        window.sendBok = async function() {
            if(!selectedRecipientUid) return alert("ë°›ëŠ” ì‚¬ëŒì„ ì„ íƒí•˜ì„¸ìš”");
            const amount = parseInt(document.getElementById("sendAmount").value);
            if(!amount || amount < 1) return alert("ê¸ˆì•¡ì„ ì…ë ¥í•˜ì„¸ìš”");
            if(userData.coin < amount) return alert("BOKì´ ë¶€ì¡±í•©ë‹ˆë‹¤");
            
            if(!confirm(`${document.getElementById("recipientName").textContent}ë‹˜ì—ê²Œ ${amount.toLocaleString()} BOKì„ ë³´ë‚´ì‹œê² ìŠµë‹ˆê¹Œ?`)) return;
            
            try {
                await runTransaction(db, async (t) => {
                    t.update(doc(db, "users", currentUser.uid), { coin: increment(-amount), totalSpent: increment(amount) });
                    t.update(doc(db, "users", selectedRecipientUid), { coin: increment(amount), totalEarned: increment(amount) });
                });
                
                await addDoc(collection(db, "notifications"), {
                    userId: selectedRecipientUid, type: 'bok', title: 'BOK ìˆ˜ì‹ ',
                    message: `${userData.name}ë‹˜ì´ ${amount.toLocaleString()} BOKì„ ë³´ëƒˆìŠµë‹ˆë‹¤!`,
                    read: false, createdAt: new Date().toISOString()
                });
                
                alert(`âœ… ${amount.toLocaleString()} BOK ì†¡ê¸ˆ ì™„ë£Œ!`);
                closeModal('sendBokModal');
                clearRecipient();
                document.getElementById("sendAmount").value = "";
            } catch(e) { alert("ì˜¤ë¥˜: " + e); }
        };

        // ì—…ì 
        const allAchievements = [
            { id: 'first_post', icon: 'âœï¸', title: 'ì²« ê¸€ ì‘ì„±', desc: 'ì²« ë²ˆì§¸ ê¸€ì„ ì‘ì„±í•˜ì„¸ìš”', reward: 50, check: u => (u.postCount||0) >= 1 },
            { id: 'writer_10', icon: 'ğŸ“', title: 'ì‘ê°€', desc: 'ê¸€ 10ê°œ ì‘ì„±', reward: 100, check: u => (u.postCount||0) >= 10 },
            { id: 'writer_100', icon: 'ğŸ“š', title: 'ë¬¸í•„ê°€', desc: 'ê¸€ 100ê°œ ì‘ì„±', reward: 1000, check: u => (u.postCount||0) >= 100 },
            { id: 'board_owner', icon: 'ğŸ—ï¸', title: 'ê²Œì‹œíŒ ì‚¬ì¥ë‹˜', desc: 'ê²Œì‹œíŒ ì²« ê°œì„¤', reward: 200, check: u => (u.boardCount||0) >= 1 },
            { id: 'landlord', icon: 'ğŸ ', title: 'ì§€ì£¼', desc: 'ë•… 5ê°œ ì†Œìœ ', reward: 300, check: u => (u.landCount||0) >= 5 },
            { id: 'tycoon', icon: 'ğŸ°', title: 'ëŒ€ì§€ì£¼', desc: 'ë•… 20ê°œ ì†Œìœ ', reward: 1000, check: u => (u.landCount||0) >= 20 },
            { id: 'social', icon: 'ğŸ’¬', title: 'ìˆ˜ë‹¤ìŸì´', desc: 'ëŒ“ê¸€ 50ê°œ ì‘ì„±', reward: 200, check: u => (u.commentCount||0) >= 50 },
            { id: 'influencer', icon: 'ğŸ‘¥', title: 'ì¸í”Œë£¨ì–¸ì„œ', desc: 'ì¹œêµ¬ 10ëª… ì´ˆëŒ€', reward: 500, check: u => (u.inviteCount||0) >= 10 },
            { id: 'whale', icon: 'ğŸ‹', title: 'ê³ ë˜', desc: 'ëˆ„ì  ìˆ˜ìµ 10,000 BOK', reward: 500, check: u => (u.totalEarned||0) >= 10000 },
            { id: 'streak_30', icon: 'ğŸ”¥', title: 'ì¶œì„ì˜ ë‹¬ì¸', desc: '30ì¼ ì—°ì† ì¶œì„', reward: 1000, check: u => (u.streak||0) >= 30 }
        ];

        function loadAchievements() {
            if(!userData) return;
            const list = document.getElementById("achievementList");
            list.innerHTML = "";
            let count = 0;
            
            allAchievements.forEach(a => {
                const unlocked = a.check(userData);
                if(unlocked) count++;
                
                list.innerHTML += `
                    <div class="achievement-item">
                        <div class="achievement-icon ${unlocked ? 'achievement-unlocked' : 'achievement-locked'}">${a.icon}</div>
                        <div class="achievement-info">
                            <div class="achievement-title">${a.title}</div>
                            <div class="achievement-desc">${a.desc}</div>
                        </div>
                        <span class="mission-reward">${unlocked ? 'âœ…' : `+${a.reward} BOK`}</span>
                    </div>
                `;
            });
            
            document.getElementById("achievementCount").textContent = `${count}/${allAchievements.length} ë‹¬ì„±`;
        }

        // ì¹­í˜¸
        const allTitles = [
            { id: "newbie", title: "ğŸŒ± ìƒˆì‹¹", unlocked: true },
            { id: "writer", title: "âœï¸ ì‘ê°€", check: u => (u.postCount||0) >= 10 },
            { id: "master", title: "ğŸ“š ë¬¸í•„ê°€", check: u => (u.postCount||0) >= 100 },
            { id: "social", title: "ğŸ’¬ ìˆ˜ë‹¤ìŸì´", check: u => (u.commentCount||0) >= 50 },
            { id: "landlord", title: "ğŸ  ì§€ì£¼", check: u => (u.landCount||0) >= 5 },
            { id: "tycoon", title: "ğŸ° ëŒ€ì§€ì£¼", check: u => (u.landCount||0) >= 20 },
            { id: "ceo", title: "ğŸ—ï¸ ì‚¬ì¥ë‹˜", check: u => (u.boardCount||0) >= 1 },
            { id: "influencer", title: "ğŸ‘¥ ì¸í”Œë£¨ì–¸ì„œ", check: u => (u.inviteCount||0) >= 10 },
            { id: "whale", title: "ğŸ‹ ê³ ë˜", check: u => (u.totalEarned||0) >= 10000 },
            { id: "streak", title: "ğŸ”¥ ì¶œì„ì™•", check: u => (u.streak||0) >= 30 }
        ];

        function updateTitleOptions() {
            const container = document.getElementById("titleSelectList");
            container.innerHTML = "";
            allTitles.forEach(t => {
                const unlocked = t.unlocked || (t.check && t.check(userData));
                const isActive = (userData.title || "ğŸŒ± ìƒˆì‹¹") === t.title;
                container.innerHTML += `
                    <div class="title-option ${isActive ? 'active' : ''} ${!unlocked ? 'locked' : ''}" 
                         data-title="${t.title}" onclick="${unlocked ? 'selectTitle(this)' : ''}">
                        ${t.title} ${!unlocked ? 'ğŸ”’' : ''}
                    </div>
                `;
            });
        }

        window.selectTitle = function(el) {
            if(el.classList.contains('locked')) return;
            document.querySelectorAll('.title-option').forEach(e => e.classList.remove('active'));
            el.classList.add('active');
        };

        window.saveProfileSettings = async function() {
            const country = document.getElementById("countrySelect").value;
            const activeTitle = document.querySelector('.title-option.active');
            const title = activeTitle ? activeTitle.dataset.title : "ğŸŒ± ìƒˆì‹¹";
            
            await updateDoc(doc(db, "users", currentUser.uid), { country, title });
            alert("ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!");
            closeModal('profileSettingsModal');
        };

        window.logout = async function() {
            if(!confirm("ë¡œê·¸ì•„ì›ƒ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) return;
            await signOut(auth);
            location.reload();
        };

        // ì´ˆëŒ€ ì½”ë“œ
        function checkInviteCodeBanner() {
            if(!userData) return;
            if(userData.inviteCodeUsed) {
                document.getElementById("inviteCodeBanner").classList.add("hidden");
                document.getElementById("inviteCodeEntrySection").style.display = "none";
                return;
            }
            
            const createdAt = new Date(userData.createdAt);
            const now = new Date();
            const daysDiff = Math.floor((now - createdAt) / (1000 * 60 * 60 * 24));
            const daysLeft = 7 - daysDiff;
            
            if(daysLeft > 0) {
                document.getElementById("inviteCodeBanner").classList.remove("hidden");
                document.getElementById("inviteCodeEntrySection").style.display = "block";
                document.getElementById("inviteCodeDaysLeft").textContent = `â° ${daysLeft}ì¼ ë‚¨ìŒ`;
            } else {
                document.getElementById("inviteCodeBanner").classList.add("hidden");
                document.getElementById("inviteCodeEntrySection").style.display = "none";
            }
        }

        window.applyInviteCode = async function() {
            const code = document.getElementById("enterInviteCode").value.trim().toUpperCase();
            if(!code) return alert("ì´ˆëŒ€ ì½”ë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”.");
            if(code === userData.inviteCode) return alert("ìì‹ ì˜ ì½”ë“œëŠ” ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
            if(userData.inviteCodeUsed) return alert("ì´ë¯¸ ì´ˆëŒ€ ì½”ë“œë¥¼ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.");
            
            const createdAt = new Date(userData.createdAt);
            const daysDiff = Math.floor((new Date() - createdAt) / (1000 * 60 * 60 * 24));
            if(daysDiff >= 7) return alert("ì´ˆëŒ€ ì½”ë“œëŠ” ê°€ì… 7ì¼ ë‚´ì—ë§Œ ì…ë ¥ ê°€ëŠ¥í•©ë‹ˆë‹¤.");
            
            const inviterQuery = query(collection(db, "users"), where("inviteCode", "==", code));
            const inviterSnap = await getDocs(inviterQuery);
            if(inviterSnap.empty) return alert("ìœ íš¨í•˜ì§€ ì•Šì€ ì´ˆëŒ€ ì½”ë“œì…ë‹ˆë‹¤.");
            
            const inviterDoc = inviterSnap.docs[0];
            const inviterUid = inviterDoc.id;
            
            try {
                await updateDoc(doc(db, "users", inviterUid), { 
                    coin: increment(300), totalEarned: increment(300),
                    inviteCount: increment(1), inviteRewards: increment(300)
                });
                
                await updateDoc(doc(db, "users", currentUser.uid), { 
                    coin: increment(500), totalEarned: increment(500),
                    invitedBy: inviterUid, inviteCodeUsed: true
                });
                
                await addDoc(collection(db, "invites"), {
                    inviterUid, inviteeUid: currentUser.uid, inviteeName: currentUser.displayName,
                    stage1: true, stage2: false, stage3: false,
                    stage1At: new Date().toISOString(), createdAt: new Date().toISOString()
                });
                
                alert("ğŸ‰ ì´ˆëŒ€ ì½”ë“œ ì ìš© ì™„ë£Œ! +500 BOK!");
                closeModal('profileSettingsModal');
                document.getElementById("inviteCodeBanner").classList.add("hidden");
            } catch(e) { alert("ì˜¤ë¥˜: " + e); }
        };

        async function loadInvitedFriends() {
            if(!currentUser) return;
            const q = query(collection(db, "invites"), where("inviterUid", "==", currentUser.uid));
            const snapshot = await getDocs(q);
            
            const list = document.getElementById("invitedFriendsList");
            let activeCount = 0;
            
            if(snapshot.empty) {
                list.innerHTML = '<p style="text-align: center; color: var(--text-muted); padding: 16px;">ì•„ì§ ì´ˆëŒ€í•œ ì¹œêµ¬ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
                return;
            }
            
            let invites = [];
            snapshot.forEach(docSnap => invites.push({ id: docSnap.id, ...docSnap.data() }));
            invites.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));
            
            list.innerHTML = "";
            invites.forEach(inv => {
                if(inv.stage2 || inv.stage3) activeCount++;
                list.innerHTML += `
                    <div class="invited-friend">
                        <span>${inv.inviteeName || 'ì¹œêµ¬'}</span>
                        <div class="friend-status">
                            <div class="status-badge ${inv.stage1 ? 'done' : 'pending'}" title="ê°€ì…"></div>
                            <div class="status-badge ${inv.stage2 ? 'done' : 'pending'}" title="ì²« ê¸€"></div>
                            <div class="status-badge ${inv.stage3 ? 'done' : 'pending'}" title="ì²« ë•…"></div>
                        </div>
                    </div>
                `;
            });
            
            document.getElementById("inviteActive").textContent = activeCount;
        }

        window.copyInviteLink = function() {
            navigator.clipboard.writeText(document.getElementById("inviteLinkInput").value);
            alert("ğŸ“ ì´ˆëŒ€ ë§í¬ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!");
        };

        window.copyInviteCode = function() {
            navigator.clipboard.writeText(userData?.inviteCode || '');
            alert("ğŸ“‹ ì´ˆëŒ€ ì½”ë“œê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!");
        };

        // ê²Œì‹œíŒ
        async function loadBoards() {
            const q = query(collection(db, "boards"), orderBy("createdAt", "desc"));
            onSnapshot(q, (snapshot) => {
                const list = document.getElementById("boardsList");
                const popular = document.getElementById("popularBoards");
                list.innerHTML = ""; popular.innerHTML = "";
                
                if(snapshot.empty) { 
                    list.innerHTML = `<div class="empty-state" style="padding: 60px;">
                        <div class="empty-icon">ğŸ“‚</div>
                        <div class="empty-title">ì•„ì§ ê²Œì‹œíŒì´ ì—†ì–´ìš”</div>
                        <div class="empty-desc">ì²« ë²ˆì§¸ ê²Œì‹œíŒì˜ ì£¼ì¸ì´ ë˜ì–´ë³´ì„¸ìš”!</div>
                    </div>`; 
                    popular.innerHTML = `<div class="empty-state">
                        <div class="empty-icon">ğŸ“‚</div>
                        <div class="empty-title">ê²Œì‹œíŒì´ ì—†ì–´ìš”</div>
                        <div class="empty-desc">ì²« ë²ˆì§¸ ê²Œì‹œíŒì„ ë§Œë“¤ì–´ë³´ì„¸ìš”!</div>
                        <div class="cta-text" onclick="openModal('createBoardModal')">ğŸ—ï¸ ê²Œì‹œíŒ ë§Œë“¤ê¸°</div>
                    </div>`;
                    return; 
                }
                
                let count = 0;
                snapshot.forEach(docSnap => {
                    const b = docSnap.data();
                    const feeText = (b.entryFee > 0) ? `<span class="board-fee">${b.entryFee} BOK</span>` : '<span style="color: var(--success); font-size: 12px;">ë¬´ë£Œ</span>';
                    const html = `
                        <div class="board-item" onclick="location.href='board.html?id=${docSnap.id}'">
                            <div class="board-icon" style="background: ${b.color||'#6366f1'};">${b.icon||'ğŸ“'}</div>
                            <div class="board-info">
                                <div class="board-name">${b.name}</div>
                                <div class="board-meta">${b.description||''}</div>
                            </div>
                            <div style="text-align: right;">
                                ${feeText}
                                <div class="board-stats" style="margin-top: 4px;">
                                    <span>ğŸ‘¤ ${b.memberCount||0}</span>
                                    <span>ğŸ“ ${b.postCount||0}</span>
                                </div>
                            </div>
                        </div>
                    `;
                    list.innerHTML += html;
                    if(count < 3) popular.innerHTML += html;
                    count++;
                });
            });
        }

        async function loadRanking() {
            const q = query(collection(db, "users"), orderBy("totalEarned", "desc"), limit(10));
            const snapshot = await getDocs(q);
            const list = document.getElementById("rankingList");
            
            if(snapshot.empty) {
                list.innerHTML = `<div class="empty-state">
                    <div class="empty-icon">ğŸ†</div>
                    <div class="empty-title">ë­í‚¹ ì§‘ê³„ ì¤‘</div>
                    <div class="empty-desc">í™œë™í•˜ê³  ë­í‚¹ì— ì´ë¦„ì„ ì˜¬ë ¤ë³´ì„¸ìš”!</div>
                    <div class="cta-text" onclick="showSection('boards')">ğŸš€ í™œë™ ì‹œì‘í•˜ê¸°</div>
                </div>`;
                return;
            }
            
            list.innerHTML = "";
            let rank = 1;
            snapshot.forEach(docSnap => {
                const u = docSnap.data();
                const posClass = rank === 1 ? 'gold' : rank === 2 ? 'silver' : rank === 3 ? 'bronze' : '';
                const flag = u.country || '';
                const title = u.title ? `<span style="font-size: 11px; background: rgba(245,158,11,0.2); color: var(--accent); padding: 2px 6px; border-radius: 10px; margin-right: 4px;">${u.title}</span>` : '';
                list.innerHTML += `
                    <div class="ranking-item">
                        <div class="ranking-position ${posClass}">${rank}</div>
                        <div class="ranking-name">${flag} ${title}${u.name||'ìµëª…'}</div>
                        <div class="ranking-score">${(u.totalEarned||0).toLocaleString()}</div>
                    </div>
                `;
                rank++;
            });
        }

        window.createBoard = async function() {
            if(!currentUser || !userData) return alert("ë¡œê·¸ì¸ í•„ìš”");
            if(userData.coin < 1000) return alert("BOK ë¶€ì¡± (í•„ìš”: 1,000)");
            const name = document.getElementById("boardName").value.trim();
            if(!name) return alert("ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”");
            
            try {
                await runTransaction(db, async (t) => {
                    t.update(doc(db, "users", currentUser.uid), { 
                        coin: increment(-1000), totalSpent: increment(1000), boardCount: increment(1) 
                    });
                    t.set(doc(collection(db, "boards")), { 
                        name, 
                        description: document.getElementById("boardDesc").value.trim(),
                        category: document.getElementById("boardCategory").value,
                        color: document.getElementById("boardColor").value,
                        icon: document.getElementById("boardIcon").value || 'ğŸ“',
                        entryFee: parseInt(document.getElementById("boardEntryFee").value) || 0,
                        writeFee: parseInt(document.getElementById("boardWriteFee").value) || 0,
                        requireApproval: document.getElementById("toggleApproval").classList.contains("active"),
                        allowComments: document.getElementById("toggleComments").classList.contains("active"),
                        ownerUid: currentUser.uid, ownerName: currentUser.displayName,
                        memberCount: 1, postCount: 0,
                        createdAt: new Date().toISOString() 
                    });
                });
                alert("ğŸ‰ ê²Œì‹œíŒ ìƒì„± ì™„ë£Œ!");
                closeModal('createBoardModal');
            } catch(e) { alert("ì˜¤ë¥˜: " + e); }
        };

        // ì„¹ì…˜ ì „í™˜
        window.showSection = function(section) {
            document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
            document.getElementById("homeSection").classList.add("hidden");
            document.getElementById("boardsSection").classList.add("hidden");
            document.getElementById("profileSection").classList.add("hidden");
            
            if(section === 'home') {
                document.getElementById("homeSection").classList.remove("hidden");
            } else if(section === 'boards') {
                document.getElementById("boardsSection").classList.remove("hidden");
            } else if(section === 'profile') {
                document.getElementById("profileSection").classList.remove("hidden");
            }
        };

        // ëª¨ë°”ì¼ ë©”ë‰´
        window.toggleMobileMenu = function() {
            document.getElementById("hamburger").classList.toggle("active");
            document.getElementById("mobileMenu").classList.toggle("active");
        };

        // ëª¨ë‹¬
        window.openModal = (id) => document.getElementById(id).style.display = "flex";
        window.closeModal = (id) => document.getElementById(id).style.display = "none";
        window.filterBoards = (type) => { 
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active')); 
            event.target.classList.add('active'); 
        };

        // í´ë¦­ ì™¸ë¶€ ë‹«ê¸°
        document.addEventListener('click', (e) => {
            if(!e.target.closest('.notification-bell')) {
                document.getElementById("notificationDropdown").classList.remove("active");
            }
        });

        // ì„œë¹„ìŠ¤ ì›Œì»¤ ë“±ë¡ (PWA)
        if('serviceWorker' in navigator) {
            // ê°„ë‹¨í•œ ì˜¤í”„ë¼ì¸ ì§€ì›ì„ ìœ„í•œ ì„œë¹„ìŠ¤ ì›Œì»¤ ë“±ë¡ì€ ë³„ë„ íŒŒì¼ í•„ìš”
            // ì—¬ê¸°ì„œëŠ” ìƒëµ
        }
    </script>
</body>
</html>
