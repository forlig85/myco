<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BOKLUCK ê²Œì‹œíŒ</title>
    <meta name="description" content="BOKLUCK ì»¤ë®¤ë‹ˆí‹° ê²Œì‹œíŒ - ê¸€ì„ ì“°ê³  BOK í† í°ì„ ë°›ìœ¼ì„¸ìš”!">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ“</text></svg>">
    <meta name="theme-color" content="#6366f1">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700;900&display=swap" rel="stylesheet">
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        :root { --primary: #6366f1; --primary-light: #818cf8; --secondary: #06b6d4; --accent: #f59e0b; --success: #10b981; --danger: #ef4444; --bg-dark: #0a0a0f; --bg-card: #12121a; --bg-card-hover: #1a1a25; --border: #2a2a3a; --text: #f0f0f5; --text-muted: #8888a0; --gradient-primary: linear-gradient(135deg, #6366f1 0%, #06b6d4 100%); --gradient-gold: linear-gradient(135deg, #f59e0b 0%, #fbbf24 100%); }
        [data-theme="light"] { --bg-dark: #f5f5f7; --bg-card: #ffffff; --bg-card-hover: #f0f0f2; --border: #e0e0e5; --text: #1a1a2e; --text-muted: #6b7280; }
        body { background-color: var(--bg-dark); color: var(--text); font-family: 'Noto Sans KR', sans-serif; min-height: 100vh; }
        .loading-overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: var(--bg-dark); display: flex; justify-content: center; align-items: center; z-index: 9999; transition: opacity 0.5s; }
        .loading-overlay.fade-out { opacity: 0; pointer-events: none; }
        .spinner { width: 50px; height: 50px; border: 4px solid var(--border); border-top-color: var(--primary); border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
        .navbar { background: var(--bg-card); border-bottom: 1px solid var(--border); padding: 12px 20px; position: sticky; top: 0; z-index: 100; }
        .nav-container { max-width: 900px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center; }
        .logo { font-size: 24px; font-weight: 900; background: var(--gradient-primary); -webkit-background-clip: text; -webkit-text-fill-color: transparent; text-decoration: none; }
        .nav-links { display: flex; gap: 8px; }
        .nav-link { padding: 8px 16px; border-radius: 8px; color: var(--text-muted); text-decoration: none; font-size: 14px; }
        .nav-link:hover, .nav-link.active { background: var(--bg-card-hover); color: var(--text); }
        .hamburger { display: none; flex-direction: column; gap: 5px; cursor: pointer; padding: 8px; }
        .hamburger span { width: 24px; height: 2px; background: var(--text); }
        .mobile-menu { display: none; position: fixed; top: 60px; left: 0; right: 0; bottom: 0; background: var(--bg-dark); z-index: 99; padding: 20px; flex-direction: column; gap: 8px; }
        .mobile-menu.active { display: flex; }
        .mobile-menu .nav-link { padding: 16px; border-radius: 12px; background: var(--bg-card); }
        .nav-right { display: flex; align-items: center; gap: 12px; }
        .wallet-badge { background: var(--bg-dark); padding: 8px 16px; border-radius: 50px; border: 1px solid var(--border); color: var(--secondary); font-weight: 700; font-size: 14px; }
        .theme-toggle { width: 40px; height: 40px; border-radius: 50%; background: var(--bg-dark); border: 1px solid var(--border); cursor: pointer; font-size: 18px; }
        .container { max-width: 900px; margin: 0 auto; padding: 24px 20px; }
        .back-btn { display: inline-flex; align-items: center; gap: 8px; color: var(--text-muted); text-decoration: none; font-size: 14px; margin-bottom: 20px; }
        .card { background: var(--bg-card); border: 1px solid var(--border); border-radius: 16px; padding: 24px; margin-bottom: 20px; }
        button { cursor: pointer; border: none; border-radius: 10px; font-weight: 600; padding: 12px 20px; font-family: 'Noto Sans KR', sans-serif; font-size: 14px; }
        .btn-primary { background: var(--gradient-primary); color: white; }
        .btn-outline { background: transparent; border: 1px solid var(--border); color: var(--text); }
        .btn-sm { padding: 8px 14px; font-size: 13px; }
        .btn-block { width: 100%; }
        input, textarea { width: 100%; background: var(--bg-dark); border: 1px solid var(--border); color: var(--text); padding: 14px 16px; border-radius: 10px; font-size: 15px; font-family: 'Noto Sans KR', sans-serif; margin-bottom: 12px; }
        input:focus, textarea:focus { outline: none; border-color: var(--primary); }
        label { display: block; font-size: 13px; color: var(--text-muted); margin-bottom: 6px; }
        .board-header { display: flex; align-items: center; gap: 20px; margin-bottom: 24px; }
        .board-icon { width: 64px; height: 64px; border-radius: 16px; display: flex; align-items: center; justify-content: center; font-size: 32px; }
        .board-info h1 { font-size: 24px; margin-bottom: 4px; }
        .board-meta { color: var(--text-muted); font-size: 14px; }
        .board-actions { margin-left: auto; display: flex; gap: 8px; }
        .subscribe-btn.subscribed { background: var(--success); color: white; }
        .tabs { display: flex; gap: 4px; background: var(--bg-dark); padding: 4px; border-radius: 12px; margin-bottom: 20px; }
        .tab { flex: 1; padding: 10px; text-align: center; border-radius: 8px; font-weight: 600; font-size: 14px; cursor: pointer; color: var(--text-muted); }
        .tab.active { background: var(--bg-card); color: var(--text); }
        .write-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; }
        .hashtag-input { display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 12px; }
        .hashtag { background: rgba(99,102,241,0.2); color: var(--primary-light); padding: 4px 12px; border-radius: 20px; font-size: 13px; display: flex; align-items: center; gap: 6px; }
        .post-item { background: var(--bg-dark); border: 1px solid var(--border); border-radius: 14px; padding: 20px; margin-bottom: 12px; cursor: pointer; transition: all 0.2s; }
        .post-item:hover { border-color: var(--primary); transform: translateX(4px); }
        .post-header { display: flex; align-items: center; gap: 12px; margin-bottom: 12px; }
        .post-avatar { width: 40px; height: 40px; border-radius: 50%; background: var(--gradient-primary); display: flex; align-items: center; justify-content: center; font-size: 18px; }
        .post-author { font-weight: 600; font-size: 14px; }
        .post-time { font-size: 12px; color: var(--text-muted); }
        .post-title { font-size: 17px; font-weight: 700; margin-bottom: 8px; display: flex; align-items: center; gap: 8px; }
        .post-title .hot-badge { background: var(--danger); color: white; font-size: 10px; padding: 2px 8px; border-radius: 10px; }
        .post-content { color: var(--text-muted); font-size: 14px; line-height: 1.6; margin-bottom: 12px; display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden; }
        .post-hashtags { display: flex; flex-wrap: wrap; gap: 6px; margin-bottom: 12px; }
        .post-hashtag { background: rgba(99,102,241,0.15); color: var(--primary-light); padding: 3px 10px; border-radius: 15px; font-size: 12px; }
        .post-footer { display: flex; align-items: center; gap: 16px; }
        .post-stat { display: flex; align-items: center; gap: 4px; font-size: 13px; color: var(--text-muted); }
        .post-stat.liked { color: var(--danger); }
        .empty-state { text-align: center; padding: 60px 20px; }
        .empty-state .empty-icon { font-size: 48px; margin-bottom: 12px; opacity: 0.5; }
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); display: none; justify-content: center; align-items: flex-start; z-index: 1000; backdrop-filter: blur(8px); overflow-y: auto; padding: 40px 20px; }
        .modal-content { background: var(--bg-card); border-radius: 20px; width: 100%; max-width: 700px; border: 1px solid var(--border); position: relative; }
        .modal-close { position: absolute; top: 16px; right: 16px; background: var(--bg-dark); border: none; width: 36px; height: 36px; border-radius: 50%; cursor: pointer; font-size: 18px; color: var(--text-muted); }
        .post-detail-header { padding: 24px 24px 0; }
        .post-detail-title { font-size: 22px; font-weight: 900; margin-bottom: 16px; }
        .post-detail-meta { display: flex; align-items: center; gap: 12px; padding-bottom: 16px; border-bottom: 1px solid var(--border); }
        .post-detail-content { padding: 24px; line-height: 1.8; font-size: 15px; white-space: pre-wrap; }
        .post-detail-actions { padding: 16px 24px; border-top: 1px solid var(--border); display: flex; gap: 12px; }
        .action-btn { display: flex; align-items: center; gap: 6px; padding: 10px 16px; background: var(--bg-dark); border-radius: 10px; cursor: pointer; font-size: 14px; }
        .action-btn.liked { color: var(--danger); }
        .comments-section { padding: 24px; border-top: 1px solid var(--border); }
        .comment-write { display: flex; gap: 12px; margin-bottom: 20px; }
        .comment-write textarea { flex: 1; margin: 0; min-height: 60px; resize: none; }
        .comment-item { background: var(--bg-dark); border-radius: 12px; padding: 16px; margin-bottom: 12px; }
        .comment-header { display: flex; align-items: center; gap: 10px; margin-bottom: 8px; }
        .comment-avatar { width: 32px; height: 32px; border-radius: 50%; background: var(--gradient-primary); display: flex; align-items: center; justify-content: center; font-size: 14px; }
        .comment-author { font-weight: 600; font-size: 13px; }
        .comment-time { font-size: 11px; color: var(--text-muted); }
        .comment-content { font-size: 14px; line-height: 1.5; }
        .comment-content .mention { color: var(--primary-light); }
        .hidden { display: none !important; }
        @media (max-width: 768px) { .nav-links { display: none; } .hamburger { display: flex; } .board-header { flex-direction: column; text-align: center; } .board-actions { margin: 16px 0 0 0; } }
    </style>
</head>
<body>
    <div class="loading-overlay" id="loadingOverlay"><div class="spinner"></div></div>
    <nav class="navbar">
        <div class="nav-container">
            <a href="index.html" class="logo">BOKLUCK</a>
            <div class="nav-links">
                <a href="index.html" class="nav-link">ğŸ  í™ˆ</a>
                <a href="index.html" class="nav-link active">ğŸ“‚ ê²Œì‹œíŒ</a>
                <a href="market.html" class="nav-link">ğŸ—ºï¸ ë¶€ë™ì‚°</a>
                <a href="board-market.html" class="nav-link">ğŸª ë§ˆì¼“</a>
            </div>
            <div class="nav-right">
                <button class="theme-toggle" id="themeToggle" onclick="toggleTheme()">ğŸŒ™</button>
                <div class="wallet-badge" id="walletBadge">ğŸ’° ì—°ê²° í•„ìš”</div>
                <div class="hamburger" onclick="toggleMobileMenu()"><span></span><span></span><span></span></div>
            </div>
        </div>
    </nav>
    <div class="mobile-menu" id="mobileMenu">
        <a href="index.html" class="nav-link">ğŸ  í™ˆ</a>
        <a href="market.html" class="nav-link">ğŸ—ºï¸ ë¶€ë™ì‚°</a>
        <a href="board-market.html" class="nav-link">ğŸª ë§ˆì¼“</a>
    </div>
    <div class="container">
        <a href="index.html" class="back-btn">â† ê²Œì‹œíŒ ëª©ë¡</a>
        <div class="card">
            <div class="board-header">
                <div class="board-icon" id="boardIcon" style="background: #6366f1;">ğŸ“</div>
                <div class="board-info">
                    <h1 id="boardName">ê²Œì‹œíŒ ì´ë¦„</h1>
                    <div class="board-meta"><span id="boardDesc">ì„¤ëª…</span> Â· <span id="boardOwner">ìš´ì˜ì</span> Â· ğŸ‘¤ <span id="memberCount">0</span> Â· ğŸ“ <span id="postCount">0</span></div>
                </div>
                <div class="board-actions">
                    <button class="btn-outline btn-sm subscribe-btn" id="subscribeBtn" onclick="toggleSubscribe()">â­ êµ¬ë…</button>
                </div>
            </div>
        </div>
        <div class="card">
            <div class="write-header"><h3>âœï¸ ìƒˆ ê¸€ ì‘ì„±</h3><span id="writeCost" style="color: var(--accent);">ì‘ì„±ë¹„: 0 BOK</span></div>
            <input type="text" id="postTitle" placeholder="ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”">
            <textarea id="postContent" rows="5" placeholder="ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”..."></textarea>
            <div class="hashtag-input" id="hashtagContainer"></div>
            <input type="text" id="hashtagInput" placeholder="í•´ì‹œíƒœê·¸ ì…ë ¥ í›„ Enter" onkeypress="addHashtag(event)">
            <button class="btn-primary btn-block" onclick="writePost()" style="margin-top: 16px;">ê¸€ ì‘ì„±í•˜ê¸° (+100 BOK)</button>
        </div>
        <div class="tabs">
            <div class="tab active" onclick="filterPosts('latest')">ìµœì‹ ìˆœ</div>
            <div class="tab" onclick="filterPosts('popular')">ì¸ê¸°ìˆœ</div>
        </div>
        <div id="postList"><div class="empty-state"><div class="empty-icon">ğŸ“</div><p>ì•„ì§ ê²Œì‹œê¸€ì´ ì—†ìŠµë‹ˆë‹¤</p></div></div>
    </div>
    <div class="modal-overlay" id="postDetailModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('postDetailModal')">âœ•</button>
            <div class="post-detail-header">
                <div class="post-detail-title" id="detailTitle">ì œëª©</div>
                <div class="post-detail-meta"><div class="post-avatar">ğŸ‘¤</div><div><div class="post-author" id="detailAuthor">ì‘ì„±ì</div><div class="post-time" id="detailTime">ì‹œê°„</div></div></div>
            </div>
            <div class="post-detail-content" id="detailContent">ë‚´ìš©</div>
            <div class="post-detail-actions">
                <div class="action-btn" id="likeBtn" onclick="toggleLike()">â¤ï¸ <span id="likeCount">0</span></div>
                <div class="action-btn" onclick="sharePost()">ğŸ”— ê³µìœ </div>
            </div>
            <div class="comments-section">
                <h4>ğŸ’¬ ëŒ“ê¸€ <span id="commentCount">0</span></h4>
                <div class="comment-write" style="margin-top: 16px;">
                    <textarea id="commentInput" placeholder="ëŒ“ê¸€ì„ ì…ë ¥í•˜ì„¸ìš”..."></textarea>
                    <button class="btn-primary" onclick="writeComment()">ì‘ì„±</button>
                </div>
                <div id="commentList"></div>
            </div>
        </div>
    </div>
    <script>
        window.toggleTheme = function() { const t = document.documentElement.getAttribute('data-theme') === 'light' ? 'dark' : 'light'; document.documentElement.setAttribute('data-theme', t); document.getElementById('themeToggle').textContent = t === 'light' ? 'â˜€ï¸' : 'ğŸŒ™'; localStorage.setItem('theme', t); };
        const st = localStorage.getItem('theme') || 'dark'; document.documentElement.setAttribute('data-theme', st); document.getElementById('themeToggle').textContent = st === 'light' ? 'â˜€ï¸' : 'ğŸŒ™';
        window.toggleMobileMenu = function() { document.getElementById("mobileMenu").classList.toggle("active"); };
        window.addEventListener('load', () => { setTimeout(() => document.getElementById("loadingOverlay").classList.add("fade-out"), 500); });
    </script>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
        import { getFirestore, collection, doc, getDoc, updateDoc, onSnapshot, query, orderBy, where, increment, runTransaction, addDoc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";
        import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
        const firebaseConfig = { apiKey: "AIzaSyBwQjuqgWM4YKnqu_gzNbeCg5alrC-jVcQ", authDomain: "myco-737a0.firebaseapp.com", projectId: "myco-737a0", storageBucket: "myco-737a0.firebasestorage.app", messagingSenderId: "942571332540", appId: "1:942571332540:web:be0bb6fbdd32655501c1b9" };
        const app = initializeApp(firebaseConfig); const db = getFirestore(app); const auth = getAuth(app);
        let currentUser = null, userData = null, boardData = null, currentPostId = null, hashtags = [];
        const urlParams = new URLSearchParams(window.location.search); const boardId = urlParams.get('id');
        async function loadBoard() { if(!boardId) return; onSnapshot(doc(db, "boards", boardId), (d) => { if(!d.exists()) return; boardData = d.data(); document.getElementById("boardName").textContent = boardData.name; document.getElementById("boardDesc").textContent = boardData.description || ""; document.getElementById("boardOwner").textContent = boardData.ownerName; document.getElementById("boardIcon").style.background = boardData.color || "#6366f1"; document.getElementById("boardIcon").textContent = boardData.icon || "ğŸ“"; document.getElementById("memberCount").textContent = boardData.memberCount || 0; document.getElementById("postCount").textContent = boardData.postCount || 0; document.getElementById("writeCost").textContent = "ì‘ì„±ë¹„: " + (boardData.writeFee || 0) + " BOK"; document.title = boardData.name + " - BOKLUCK"; }); loadPosts(); }
        function loadPosts() { const q = query(collection(db, "posts"), where("boardId", "==", boardId), orderBy("createdAt", "desc")); onSnapshot(q, (s) => { const l = document.getElementById("postList"); if(s.empty) { l.innerHTML = '<div class="empty-state"><div class="empty-icon">ğŸ“</div><p>ì•„ì§ ê²Œì‹œê¸€ì´ ì—†ìŠµë‹ˆë‹¤</p></div>'; return; } l.innerHTML = ""; s.forEach(d => { const p = d.data(); const isHot = (p.likeCount || 0) >= 5; let tags = ''; if(p.hashtags?.length) tags = '<div class="post-hashtags">' + p.hashtags.map(t => '<span class="post-hashtag">#' + t + '</span>').join('') + '</div>'; l.innerHTML += '<div class="post-item" onclick="openPostDetail(\'' + d.id + '\')"><div class="post-header"><div class="post-avatar">' + (p.authorCountry || 'ğŸ‘¤') + '</div><div><div class="post-author">' + p.authorName + '</div><div class="post-time">' + timeAgo(p.createdAt) + '</div></div></div><div class="post-title">' + (isHot ? '<span class="hot-badge">ğŸ”¥ HOT</span>' : '') + p.title + '</div><div class="post-content">' + p.content + '</div>' + tags + '<div class="post-footer"><div class="post-stat">â¤ï¸ ' + (p.likeCount || 0) + '</div><div class="post-stat">ğŸ’¬ ' + (p.commentCount || 0) + '</div><div class="post-stat">ğŸ‘ï¸ ' + (p.viewCount || 0) + '</div></div></div>'; }); }); }
        window.openPostDetail = async function(id) { currentPostId = id; await updateDoc(doc(db, "posts", id), { viewCount: increment(1) }); onSnapshot(doc(db, "posts", id), (d) => { if(!d.exists()) return; const p = d.data(); document.getElementById("detailTitle").textContent = p.title; document.getElementById("detailAuthor").textContent = (p.authorCountry || '') + ' ' + p.authorName; document.getElementById("detailTime").textContent = timeAgo(p.createdAt); document.getElementById("detailContent").innerHTML = p.content.replace(/@(\w+)/g, '<span class="mention">@$1</span>'); document.getElementById("likeCount").textContent = p.likeCount || 0; document.getElementById("commentCount").textContent = p.commentCount || 0; const isLiked = currentUser && p.likedBy?.includes(currentUser.uid); document.getElementById("likeBtn").className = 'action-btn ' + (isLiked ? 'liked' : ''); }); loadComments(id); openModal('postDetailModal'); };
        function loadComments(id) { const q = query(collection(db, "comments"), where("postId", "==", id), orderBy("createdAt", "asc")); onSnapshot(q, (s) => { const l = document.getElementById("commentList"); l.innerHTML = ""; s.forEach(d => { const c = d.data(); l.innerHTML += '<div class="comment-item"><div class="comment-header"><div class="comment-avatar">' + (c.authorCountry || 'ğŸ‘¤') + '</div><div><span class="comment-author">' + c.authorName + '</span> <span class="comment-time">' + timeAgo(c.createdAt) + '</span></div></div><div class="comment-content">' + c.content.replace(/@(\w+)/g, '<span class="mention">@$1</span>') + '</div></div>'; }); }); }
        window.toggleLike = async function() { if(!currentUser || !currentPostId) return alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤."); const ref = doc(db, "posts", currentPostId); const snap = await getDoc(ref); const p = snap.data(); const liked = p.likedBy || []; if(liked.includes(currentUser.uid)) { await updateDoc(ref, { likedBy: liked.filter(i => i !== currentUser.uid), likeCount: increment(-1) }); } else { await updateDoc(ref, { likedBy: [...liked, currentUser.uid], likeCount: increment(1) }); } };
        window.writeComment = async function() { if(!currentUser) return alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤."); const c = document.getElementById("commentInput").value.trim(); if(!c) return alert("ëŒ“ê¸€ì„ ì…ë ¥í•˜ì„¸ìš”."); await addDoc(collection(db, "comments"), { postId: currentPostId, boardId, authorUid: currentUser.uid, authorName: currentUser.displayName, authorCountry: userData?.country || '', content: c, createdAt: new Date().toISOString() }); await updateDoc(doc(db, "posts", currentPostId), { commentCount: increment(1) }); document.getElementById("commentInput").value = ""; };
        window.addHashtag = function(e) { if(e.key !== 'Enter') return; e.preventDefault(); const i = document.getElementById("hashtagInput"); const t = i.value.trim().replace(/^#/, ''); if(!t || hashtags.includes(t) || hashtags.length >= 5) return; hashtags.push(t); document.getElementById("hashtagContainer").innerHTML = hashtags.map((x, j) => '<span class="hashtag">#' + x + ' <span onclick="removeHashtag(' + j + ')" style="cursor:pointer;">âœ•</span></span>').join(''); i.value = ""; };
        window.removeHashtag = function(i) { hashtags.splice(i, 1); document.getElementById("hashtagContainer").innerHTML = hashtags.map((x, j) => '<span class="hashtag">#' + x + ' <span onclick="removeHashtag(' + j + ')" style="cursor:pointer;">âœ•</span></span>').join(''); };
        window.writePost = async function() { if(!currentUser) return alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤."); const title = document.getElementById("postTitle").value.trim(); const content = document.getElementById("postContent").value.trim(); if(!title || !content) return alert("ì œëª©ê³¼ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”."); const fee = boardData?.writeFee || 0; if(userData.coin < fee) return alert("BOKì´ ë¶€ì¡±í•©ë‹ˆë‹¤!"); try { await runTransaction(db, async (t) => { t.update(doc(db, "users", currentUser.uid), { coin: increment(100 - fee), totalEarned: increment(100), totalSpent: increment(fee), postCount: increment(1), exp: increment(10) }); t.update(doc(db, "boards", boardId), { postCount: increment(1) }); t.set(doc(collection(db, "posts")), { boardId, authorUid: currentUser.uid, authorName: currentUser.displayName, authorCountry: userData?.country || '', title, content, hashtags, likeCount: 0, likedBy: [], commentCount: 0, viewCount: 0, createdAt: new Date().toISOString() }); }); document.getElementById("postTitle").value = ""; document.getElementById("postContent").value = ""; hashtags = []; document.getElementById("hashtagContainer").innerHTML = ""; alert("ğŸ‰ ê¸€ ì‘ì„± ì™„ë£Œ! +100 BOK"); } catch(e) { alert("ì˜¤ë¥˜: " + e); } };
        window.toggleSubscribe = async function() { if(!currentUser) return alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤."); const b = document.getElementById("subscribeBtn"); b.classList.toggle("subscribed"); if(b.classList.contains("subscribed")) { b.innerHTML = "â­ êµ¬ë…ì¤‘"; await updateDoc(doc(db, "boards", boardId), { memberCount: increment(1) }); } else { b.innerHTML = "â­ êµ¬ë…"; await updateDoc(doc(db, "boards", boardId), { memberCount: increment(-1) }); } };
        window.sharePost = function() { navigator.clipboard.writeText(window.location.href); alert("ğŸ”— ë§í¬ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!"); };
        window.filterPosts = function(t) { document.querySelectorAll('.tab').forEach(x => x.classList.remove('active')); event.target.classList.add('active'); };
        function timeAgo(d) { const m = Math.floor((Date.now() - new Date(d).getTime()) / 60000); if(m < 1) return 'ë°©ê¸ˆ ì „'; if(m < 60) return m + 'ë¶„ ì „'; const h = Math.floor(m / 60); if(h < 24) return h + 'ì‹œê°„ ì „'; return Math.floor(h / 24) + 'ì¼ ì „'; }
        onAuthStateChanged(auth, (u) => { if(u) { currentUser = u; onSnapshot(doc(db, "users", u.uid), (d) => { if(d.exists()) { userData = d.data(); document.getElementById("walletBadge").innerText = 'ğŸ’° ' + (userData.coin||0).toLocaleString() + ' BOK'; } }); } else { document.getElementById("walletBadge").innerText = "ğŸ’° ë¡œê·¸ì¸ í•„ìš”"; } });
        window.openModal = (id) => document.getElementById(id).style.display = "flex";
        window.closeModal = (id) => document.getElementById(id).style.display = "none";
        loadBoard();
    </script>
</body>
</html>
